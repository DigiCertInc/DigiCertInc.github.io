<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" >
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
  <title>Archives: 2014/4 | Blog of Secer</title>
  <meta name="description" content="" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="MobileOptimized" content="320" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" type="text/css" href="/css/screen.css" />
  <link rel="stylesheet" type="text/css" href="/css/style.css" />
  <meta name="generator" content="Blog of Secer">

  
  
  

  
</head>

<!--
<body class="home-template">
-->
<body class="home-template">
<div id="perspective" class="perspective effect-movedown">
  <div class="container">
    <!-- wrapper -->
    <div class="wrapper">

      <header class="site-head"  style="background: #24282b url(/img/img-bg.jpg) 0 -20%" >
    <div class="vertical">
        <div class="site-head-content inner">
             <a class="blog-logo" href="/"><img src="/img/logo.svg" alt="Blog Logo"/></a> 
            <h1 class="blog-title">Blog of Secer</h1>
            <h2 class="blog-description"><button id="showMenu">Show Menu</button></h2>
        </div>
    </div>
</header>

      
<main class="content" role="main">
  
  <article class="post">
    <header class="post-header">
      <span class="post-meta">
      <time datetime="2014-04-26T11:36:26.000Z" itemprop="datePublished">
          2014-04-26
      </time>
    
    
    | 
    <a href='/tag/CSRF/'>CSRF</a>
    
    
</span>
      <h2 class="post-title"><a href="/1080.seo/">Flash CSRF</a></h2>
    </header>
    <section class="post-excerpt">
      <p>
      
        目录    0x00 Flash CSRF名词解释0x01 Flash CSRF形成的原因0x02 Flash CSRF可以干些什么0x03 Flash CSRF如何利用0x04 Flash CSRF怎么防御0x00 Flash CSRF名词解释



CSRF（Cross-site request forgery跨站请求伪造，是一种对网站的恶意利用，CSRF则通过伪装来自受信任用户的请求来利用受信任的网站。

Flash CSRF通常
      
      </p>
      
      <p>
          <a href="/1080.seo/" class="excerpt-link">Read More...</a>
      </p>
      
    </section>
  </article>
  
  <article class="post">
    <header class="post-header">
      <span class="post-meta">
      <time datetime="2014-04-24T23:13:14.000Z" itemprop="datePublished">
          2014-04-25
      </time>
    
    
    | 
    <a href='/tag/xss/'>xss</a>
    
    
</span>
      <h2 class="post-title"><a href="/1079.seo/">header的安全配置指南</a></h2>
    </header>
    <section class="post-excerpt">
      <p>
      
        <p>0x00 背景</p>  <hr align="left" size="5" width="100%" noshade="noshade" />  <p>在统计了Alexa top 100万网站的header安全分析之后（2012年11月 - 2013年3月 - 2013年11月），我们发现其实如何正确的设置一个header并不是一件容易的事情。尽管有数不胜数的网站会使用大量有关安全方面的header，但并没有一个像样的平台能够为开发者们提供必要的信息，以辨别那些常见的错误设置。或者说，即使这些安全方面的header设置正确了，也没有一个平台能够为开发者提供一个系统的测试方法，用来测试正确与否。这些header如果设置错误了不仅会产生安全的假象，甚至会对网站的安全产生威胁。veracode认为安全性header是网络防护中非常重要的一环，并且他希望让开发者们能够简捷、正确地设置站点。如果您对某一header或设置有任何疑问，我们有极好的资源能够追踪到浏览器支持情况。</p>  <p>0x01 细节</p>  <hr align="left" size="5" width="100%" noshade="noshade" />  <h3>1. X-XSS-Protection</h3>  <p><b>目的</b></p>  <p>这个header主要是用来防止浏览器中的反射性<a href="http://ha.cker.in/tag/xss" target="_blank">xss</a>。现在，只有IE，chrome和safari（webkit）支持这个header。</p>  <p><b>正确的设置</b></p>  <p>0 – 关闭对浏览器的<a href="http://ha.cker.in/tag/xss" target="_blank">xss</a>防护</p>  <p>1 – 开启xss防护</p>  <p>1; mode=block – 开启xss防护并通知浏览器阻止而不是过滤用户注入的脚本。</p>  <p>1; report=<a href="http://site.com/report">http://site.com/report</a> – 这个只有chrome和webkit内核的浏览器支持，这种模式告诉浏览器当发现疑似xss攻击的时候就将这部分数据post到指定地址。</p>  <p><b>通常不正确的设置</b></p>  <p>0; mode=block; – 记住当配置为0的时候，即使加了mode=block选项也是没有效果的。需要指出的是，chrome在发现这种错误的配置后还是会开启xss防护。</p>  <p>1 mode=block; – 数字和选项之间必须是用分号分割，逗号和空格都是错误的。但是这种错误配置情况下，IE和chrome还是默认会清洗xss攻击，但是不会阻拦。</p>  <p><b>如何检测</b></p>  <p>如果过滤器检测或阻拦了一个反射性xss以后,IE会弹出一个对话框。当设置为1时，chrome会隐藏对反射性xss的输出。如果是设置为 1; mode=block ,那么chrome会直接将user-agent置为一个空值:, URL&#160; 这种形式。</p>  <p><b>参考文献</b></p>  <p>Post from Microsoft on the X-XSS-Protection Header   <br />Chromium X-XSS-Protection Header Parsing Source    <br />Discussion of report format in WebKit bugzilla</p><br>
      
      </p>
      
      <p>
          <a href="/1079.seo/" class="excerpt-link">Read More...</a>
      </p>
      
    </section>
  </article>
  
  <article class="post">
    <header class="post-header">
      <span class="post-meta">
      <time datetime="2014-04-17T07:24:02.000Z" itemprop="datePublished">
          2014-04-17
      </time>
    
    
    | 
    <a href='/tag/SQL注入/'>SQL注入</a>
    
    
</span>
      <h2 class="post-title"><a href="/1078.seo/">浅析白盒审计中的字符编码及SQL注入</a></h2>
    </header>
    <section class="post-excerpt">
      <p>
      
        <p><b>尽管现在呼吁所有的程序都使用unicode编码，所有的网站都使用utf-8编码，来一个统一的国际规范。但仍然有很多，包括国内及国外（特别是非英语国家）的一些cms，仍然使用着自己国家的一套编码，比如gbk，作为自己默认的编码类型。</b>也有一些cms为了考虑老用户，所以出了gbk和utf-8两个版本。</p>  <p>我们就以gbk字符编码为示范，拉开帷幕。gbk是一种多字符编码，具体定义自行百度。但有一个地方尤其要注意：</p>  <p>通常来说，一个gbk编码汉字，占用2个字节。一个utf-8编码的汉字，占用3个字节。在php中，我们可以通过输出</p>  <p>echo strlen(&quot;和&quot;);</p>  <p>来测试。当将页面编码保存为gbk时输出2，utf-8时输出3。</p>  <p>除了gbk以外，所有ANSI编码都是2个字节。ansi只是一个标准，在不用的电脑上它代表的编码可能不相同，比如简体中文系统中ANSI就代表是GBK。</p>  <p>以上是一点关于多字节编码的小知识，只有我们足够了解它的组成及特性以后，才能更好地去分析它身上存在的问题。</p>  <p>说了这么多废话，现在来研究一下在<a href="http://ha.cker.in/tag/SQL注入" target="_blank">SQL注入</a>中，字符编码带来的各种问题。</p>  <p><b>0</b><b>×01 MYSQL中的宽字符注入</b><b></b></p>  <p>这是一个老话题了，也被人玩过无数遍。但作为我们这篇文章的序幕，也是基础，是必须要提的。</p>  <p>我们先搭建一个实验环境。暂且称之为phithon内容管理系统v1.0，首先先新建一个数据库，把如下压缩包中的sql文件导入：</p>  <p>测试代码及数据库：<a href="http://pan.baidu.com/s/1eQmUArw">http://pan.baidu.com/s/1eQmUArw</a> 提取密码:75tu</p>  <p>之后的phithon内容管理系统会逐步完善，但会一直使用这个数据表。</p>  <p>源码很简单（注意先关闭自己php环境的magic_quotes_gpc）：</p>  <p>&lt;?php</p>  <p>//连接数据库部分，注意使用了gbk编码，把数据库信息填写进去</p>  <p>$conn = mysql_connect(‘localhost’, ‘root’, ‘toor!@#$’) or die(‘bad!’);</p>  <p>mysql_query(&quot;SET NAMES ‘gbk’&quot;);</p>  <p>mysql_select_db(‘test’, $conn) OR emMsg(&quot;连接数据库失败，未找到您填写的数据库&quot;);</p>  <p>//执行sql语句</p>  <p>$id = isset($_GET[‘id’]) ? addslashes($_GET[‘id’]) : 1;</p>  <p>$sql = &quot;SELECT <em> FROM news WHERE tid=’{$id}’&quot;;</p>  <p>$result = mysql_query($sql, $conn) or die(mysql_error()); //sql出错会报错，方便观察</p>  <p>?&gt;</p>  <p>&lt;!DOCTYPE html&gt;</p>  <p>&lt;html&gt;</p>  <p>&lt;head&gt;</p>  <p>&lt;meta charset=&quot;gbk&quot; /&gt;</p>  <p>&lt;title&gt;新闻&lt;/title&gt;</p>  <p>&lt;/head&gt;</p>  <p>&lt;body&gt;</p>  <p>&lt;?php</p>  <p>$row = mysql_fetch_array($result, MYSQL_ASSOC);</p>  <p>echo &quot;&lt;h2&gt;{$row[‘title’]}&lt;/h2&gt;&lt;p&gt;{$row[‘content’]}&lt;p&gt;\n&quot;;</p>  <p>mysql_free_result($result);</p>  <p>?&gt;</p>  <p>&lt;/body&gt;</p>  <p>&lt;/html&gt;</p>  <p>SQL语句是SELECT </em> FROM news WHERE tid=’{$id}’，就是根据文章的id把文章从news表中取出来。</p>  <p>在这个sql语句前面，我们使用了一个addslashes函数，将$id的值转义。这是通常cms中对sql注入进行的操作，只要我们的输入参数在单引号中，就逃逸不出单引号的限制，无法注入，如下图：</p>  <p><a href="http://img.cker.in/SQL_42B9/clip_image001.jpg" rel="lightbox"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="001.jpg" border="0" alt="浅析白盒审计中的字符编码及SQL注入" src="http://img.cker.in/SQL_42B9/clip_image001_thumb.jpg" width="378" height="347" /></a></p>  <p>那么怎么逃过addslashes的限制？众所周知addslashes函数产生的效果就是，让’变成\’，让引号变得不再是“单引号”，只是一撇而已。一般绕过方式就是，想办法处理\’前面的\：</p>  <p>1.想办法给\前面再加一个\（或单数个即可），变成\’，这样\被转义了，’逃出了限制</p>  <p>2.想办法把\弄没有。</p><br>
      
      </p>
      
      <p>
          <a href="/1078.seo/" class="excerpt-link">Read More...</a>
      </p>
      
    </section>
  </article>
  
  <article class="post">
    <header class="post-header">
      <span class="post-meta">
      <time datetime="2014-04-10T21:53:04.000Z" itemprop="datePublished">
          2014-04-11
      </time>
    
    
    | 
    <a href='/tag/Webshell/'>Webshell</a>
    
    
</span>
      <h2 class="post-title"><a href="/1077.seo/">乐视渗透纪实</a></h2>
    </header>
    <section class="post-excerpt">
      <p>
      
        <p>※ 本次渗透是基于乐视官方授权许可的基础上进行的。建议各位做持续或内部渗透前，先和官方联系，取得相应许可，以免出现不必要的误会和麻烦。    <br />※ 本报告中部分信息涉及的隐私部分，将做屏蔽或替换处理。     <br />※ 应厂商意向，本专题希望各位基友仅在乌云讨论，不要外发，谢谢!     <br />详细说明：     <br />在一个月黑风高之夜，一个死宅和他的基友在乐视网看电影。突然某神经君冒出了一个想法，于是渗透就开始了。。     <br />首先，要对外网信息进行搜集。比如域名信息，IP段信息等。     <br /><a href="http://img.cker.in/13e07bc5247e_1BA2/clip_image002.jpg" rel="lightbox"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="clip_image002" border="0" alt="clip_image002" src="http://img.cker.in/13e07bc5247e_1BA2/clip_image002_thumb.jpg" width="604" height="720" /></a>     <br />然后，在115.182.C1.D1，发现了一个系统存在s2-016/017命令执行。     <br /><a href="http://img.cker.in/13e07bc5247e_1BA2/clip_image003.jpg" rel="lightbox"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="clip_image003" border="0" alt="clip_image003" src="http://img.cker.in/13e07bc5247e_1BA2/clip_image003_thumb.jpg" width="602" height="462" /></a>     <br /><a href="http://img.cker.in/13e07bc5247e_1BA2/clip_image004.jpg" rel="lightbox"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="clip_image004" border="0" alt="clip_image004" src="http://img.cker.in/13e07bc5247e_1BA2/clip_image004_thumb.jpg" width="612" height="403" /></a>     <br />不过由于各种原因，导致开代理不成功，比较悲催。。没关系，留着，继续挖。。。     <br />然后在117.121.C1.D1，发现了安恒的明鉴网页漏洞综合扫描平台系统，而且是strtus2框架，未打最新补丁！于是便拿到了此系统的权限。     <br />但是很郁闷，数据源加密了。     <br /><a href="http://img.cker.in/13e07bc5247e_1BA2/clip_image006.jpg" rel="lightbox"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="clip_image006" border="0" alt="clip_image006" src="http://img.cker.in/13e07bc5247e_1BA2/clip_image006_thumb.jpg" width="604" height="138" /></a>     <br />但是扫漏系统是一个很重要的平台，能提供大量的乐视内外部漏洞信息，怎能轻易放过呢？     <br />经过遍历，终于在一个脚本里找到了数据库密码。     <br /><a href="http://img.cker.in/13e07bc5247e_1BA2/clip_image008.jpg" rel="lightbox"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="clip_image008" border="0" alt="clip_image008" src="http://img.cker.in/13e07bc5247e_1BA2/clip_image008_thumb.jpg" width="604" height="191" /></a>     <br />然后获得管理员密码并登录。     <br /><a href="http://img.cker.in/13e07bc5247e_1BA2/clip_image009.jpg" rel="lightbox"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="clip_image009" border="0" alt="clip_image009" src="http://img.cker.in/13e07bc5247e_1BA2/clip_image009_thumb.jpg" width="618" height="286" /></a>     <br /><a href="http://img.cker.in/13e07bc5247e_1BA2/clip_image011.jpg" rel="lightbox"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="clip_image011" border="0" alt="clip_image011" src="http://img.cker.in/13e07bc5247e_1BA2/clip_image011_thumb.jpg" width="604" height="277" /></a>     <br />里面的内容很丰富啊，既有乐视大部分系统信息，又有漏洞扫描报告，很多信息都可以直接利用，同时也为下一步渗透提供了资料。</p><br>
      
      </p>
      
      <p>
          <a href="/1077.seo/" class="excerpt-link">Read More...</a>
      </p>
      
    </section>
  </article>
  
  <nav class="pagination" role="pagination">
    
    <span class="page-number">Page 1 of 1</span>
    
  </nav>
</main>


      
<footer class="site-footer">
  
  <div class="inner">
     <section class="copyright">All content copyright <a href="/">Blog of Secer</a> &copy; 2014 &bull; All rights reserved.</section>
     <section class="poweredby">Proudly published with <a class="icon-ghost" href="http://zespia.tw/hexo/">Hexo</a></section>
  </div>
</footer>

      <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>

<script type="text/javascript" src="/js/jquery.fitvids.js"></script>
<script type="text/javascript" src="/js/index.js"></script>
<script type="text/javascript" src="/js/menu.js"></script>





  </div>
</div>

<nav  class="outer-nav top horizontal">

          <a class="icon-home"  href="/"><span>Home</span></a>

          <a class="icon-news"  href="/archive"><span>Archive</span></a>

          <a class="icon-image"  href="/images"><span>Images</span></a>

          <a class="icon-wiki"  href="/wiki/2014-10-28-wiki/"><span>Wiki</span></a>

          <a class="icon-Favorites"  href="/favorites"><span>Favorites</span></a>

          <a class="icon-mail"  href="/about/2014-09-11-mabao/"><span>Contact</span></a>

</nav>

</div>
</body>
</html>
