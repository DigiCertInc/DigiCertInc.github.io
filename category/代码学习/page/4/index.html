<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" >
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
  <title>Category: 代码学习 | Blog of Secer</title>
  <meta name="description" content="" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="MobileOptimized" content="320" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" type="text/css" href="/css/screen.css" />
  <link rel="stylesheet" type="text/css" href="/css/style.css" />
  <meta name="generator" content="Blog of Secer">

  
  
  

  
</head>

<!--
<body class="home-template">
-->
<body class="home-template">
<div id="perspective" class="perspective effect-movedown">
  <div class="container">
    <!-- wrapper -->
    <div class="wrapper">

      <header class="site-head"  style="background: #24282b url(/img/img-bg.jpg) 0 -20%" >
    <div class="vertical">
        <div class="site-head-content inner">
             <a class="blog-logo" href="/"><img src="/img/logo.svg" alt="Blog Logo"/></a> 
            <h1 class="blog-title">Blog of Secer</h1>
            <h2 class="blog-description"><button id="showMenu">Show Menu</button></h2>
        </div>
    </div>
</header>

      
<main class="content" role="main">
  
  <article class="post">
    <header class="post-header">
      <span class="post-meta">
      <time datetime="2012-07-02T10:15:59.000Z" itemprop="datePublished">
          2012-07-02
      </time>
    
    
    | 
    <a href='/tag/ACL/'>ACL</a>
    
    
</span>
      <h2 class="post-title"><a href="/625.seo/">编程实现遍历ACL访问控制列表检查进程访问权限</a></h2>
    </header>
    <section class="post-excerpt">
      <p>
      
        <p><b>Author:Pnig0s[FreeBuf]</b></p>  <p>阅读本文的朋友需要对Windows访问控制模型有初步的了解，了解Token(访问令牌)，<a href="http://ha.cker.in/tag/ACL" target="_blank">ACL</a>(访问控制列表)，DACL(选择访问控制列表)，ACE(访问控制列表项)等与访问控制模型相关的名词含义及之间的关系，当然我也会在文中简要科普一下ACM。</p>  <p>写这篇文章的目的主要是最近在写一个Win下本地提权的东西，涉及到了对ACL的操作，以前对ACL总是避而远之，Windows访问控制模型比较头疼，一个API会牵出一大把要用的API。毕竟涉及到用户访问的安全，肯定不能让编程人员随意更改这些机制，复杂一些也可以理解，可是能参考的资料很少，MSDN上关于一些访问控制相关API的使用和结构体的描述也含糊不清也没有什么代码实例。这篇文章也是在查阅国外了一些文献加上自己研究测试后完成的，发出来希望对涉及这方面编程的朋友有帮助。</p>  <p><b>—&gt;&gt;</b><b>熟悉</b><b>Windows</b><b>访问控制机制的可以跳过本段：</b></p>  <p>因为是科普我这里简单介绍下Windows访问控制模型(ACM)，别嫌我啰嗦，懂得直接Pass往下看。ACM中最重要的两部分是访问令牌(Access Token)和安全描述符表(Security Descriptor)。访问令牌存在于访问主体中，安全描述符表存在于访问客体中。比如我去米国，我就是访问主体，米国就是访问客体，我持有的签证就是访问令牌。系统中访问主体是进程客体是一切系统对象。访问令牌中有当前用户的唯一标识SID，组唯一标识SID以及一些权限标志(Privilege)。安全描述符表(SD)存在于Windows系统中的任何对象中(文件，注册表，互斥量，信号量等等)。SD中包含对象所有者的SID，组SID以及两个非常重要的数据结构选择访问控制列表(DACL)和系统访问控制列表(SACL)，其中SACL涉及系统日志用的很少可以先无视。DACL中包含一个个ACE访问控制入口也是权限访问判断的核心，当一个进程访问某一对象的时候，对象会将进程的Token与自身的ACE依次比对，直到被允许或被拒绝，前面的ACE优于后面的ACE。整体的一个权限检查过程如下图：</p>  <p><b>—&gt;&gt;</b></p>  <p><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="clip_image001" border="0" alt="clip_image001" src="http://img.cker.in/ACL_1E70/clip_image001.jpg" width="389" height="264" /></p>
      
      </p>
      
      <p>
          <a href="/625.seo/" class="excerpt-link">Read More...</a>
      </p>
      
    </section>
  </article>
  
  <article class="post">
    <header class="post-header">
      <span class="post-meta">
      <time datetime="2012-06-13T08:54:05.000Z" itemprop="datePublished">
          2012-06-13
      </time>
    
    
    | 
    <a href='/tag/ASP/'>ASP</a>,
    
    <a href='/tag/FSO/'>FSO</a>,
    
    <a href='/tag/ASP中FSO的神奇功能/'>ASP中FSO的神奇功能</a>
    
    
</span>
      <h2 class="post-title"><a href="/512.seo/">ASP中FSO的神奇功能</a></h2>
    </header>
    <section class="post-excerpt">
      <p>
      
        <p>在ASP中，FSO的意思是File System Object，即文件系统对象。 </p>  <p> 我们将要操纵的计算机文件系统，在这里是指位于web服务器之上。所以，确认你对此拥有合适的权限。理想情况下，你可以在自己的机器上建立一个web服务器，这样就能方便地进行测试。如果运行于Windows平台，请试一试微软公司的免费个人Web服务器PWS。 </p>  <p> FSO 模型对象 </p>  <p> Drive Object：驱动器对象 供存取磁盘或者网络驱动器    <br /> FileSystemObject Object：文件系统对象 供存取计算机的文件系统     <br /> Folder Object：文件夹对象 供存取文件夹的所有属性     <br /> TextStream Object：文本流对象 供存取文件内容 </p>  <p> 你可以使用上面的对象做计算机上的任何事情，也包括破坏活动 ;-( 所以，请小心使用FSO。在web环境中，存储信息是非常重要的，比如用户信息，日志文件，等等。FSO提供了一个强大且简单的方法高效率地保存数据。在这篇文章里面，着重讨论FileSystemObject和TextStream对象。 </p>  <p> FSO由微软公司提供支持，对于非Windows系统，大概不能再使用ASP。 </p>  <p> 怎么样使用FSO？ </p>  <p> 为了使用FSO来执行所有的工作，首先要创建对象，代码就象下面这样： </p>  <p>＜ % Set fso = Server.CreateObject(&quot;Scripting.FileSystemObject&quot;) % ＞ </p>
      
      </p>
      
      <p>
          <a href="/512.seo/" class="excerpt-link">Read More...</a>
      </p>
      
    </section>
  </article>
  
  <article class="post">
    <header class="post-header">
      <span class="post-meta">
      <time datetime="2012-04-20T08:54:47.000Z" itemprop="datePublished">
          2012-04-20
      </time>
    
    
    | 
    <a href='/tag/VS2010/'>VS2010</a>,
    
    <a href='/tag/VS2008/'>VS2008</a>,
    
    <a href='/tag/net/'>.net</a>
    
    
</span>
      <h2 class="post-title"><a href="/393.seo/">在VS2008和VS2010中写代码，最后以.net 2.0发布，能用.net 3.5的语法</a></h2>
    </header>
    <section class="post-excerpt">
      <p>
      
        <p><p>前段时间，在vs2010里写了一下winform的代码，后来由于.net framework太大，就已.net framework 2.0发布。奇怪的是，编译的时候只是提醒如 system.linq不存在，而一些.net 3.5的语法 还能用 比如 lambda 表达式，比如说自动属性的写法，很是神奇。下面是我做的实验。 <p>显然，扩展方步不支持，编译就不通过： <p><a href="http://img.cker.in/VS2008VS2010.net2.0.net3.5_C45/clip_image001.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="clip_image001" border="0" alt="clip_image001" src="http://img.cker.in/VS2008VS2010.net2.0.net3.5_C45/clip_image001_thumb.png" width="244" height="179"></a> <p>其他的测试 编译都通过，代码如下：</p>
      
      </p>
      
      <p>
          <a href="/393.seo/" class="excerpt-link">Read More...</a>
      </p>
      
    </section>
  </article>
  
  <article class="post">
    <header class="post-header">
      <span class="post-meta">
      <time datetime="2011-11-26T05:11:32.000Z" itemprop="datePublished">
          2011-11-26
      </time>
    
    
    | 
    <a href='/tag/iphone/'>iphone</a>,
    
    <a href='/tag/iPhone开发/'>iPhone开发</a>,
    
    <a href='/tag/开发/'>开发</a>,
    
    <a href='/tag/公开课/'>公开课</a>,
    
    <a href='/tag/斯坦福大学公开课/'>斯坦福大学公开课</a>
    
    
</span>
      <h2 class="post-title"><a href="/186.seo/">斯坦福大学公开课：iPhone开发教程2010年冬_基础入门_网易公开课_网易视频</a></h2>
    </header>
    <section class="post-excerpt">
      <p>
      
        斯坦福大学公开课：iPhone开发教程2010年冬基础入门网易公开课_网易视频.

      
      </p>
      
      <p>
          <a href="/186.seo/" class="excerpt-link">Read More...</a>
      </p>
      
    </section>
  </article>
  
  <article class="post">
    <header class="post-header">
      <span class="post-meta">
      <time datetime="2011-10-11T16:50:35.000Z" itemprop="datePublished">
          2011-10-12
      </time>
    
    
    | 
    <a href='/tag/命令/'>命令</a>,
    
    <a href='/tag/VC/'>VC</a>
    
    
</span>
      <h2 class="post-title"><a href="/125.seo/">vc 隐藏执行某个命令</a></h2>
    </header>
    <section class="post-excerpt">
      <p>
      
        杀死notepad.exe进程          #include &lt;Windows.h&gt;  #include &lt;MMSystem.h&gt;  #pragma comment(lib,&quot;winmm.lib&quot;)  #pragma comment(linker,&quot;/subsystem:\&quot;windows\&quot; /entry:\&quot;mainCRTStartup\&qu
      
      </p>
      
      <p>
          <a href="/125.seo/" class="excerpt-link">Read More...</a>
      </p>
      
    </section>
  </article>
  
  <article class="post">
    <header class="post-header">
      <span class="post-meta">
      <time datetime="2011-07-12T01:15:47.000Z" itemprop="datePublished">
          2011-07-12
      </time>
    
</span>
      <h2 class="post-title"><a href="/38.seo/">2011年7月编程语言排行榜：Objective-C将成为年度语言</a></h2>
    </header>
    <section class="post-excerpt">
      <p>
      
         编程语言排行榜前10位的长期走势图：  20到50名： 
      
      </p>
      
      <p>
          <a href="/38.seo/" class="excerpt-link">Read More...</a>
      </p>
      
    </section>
  </article>
  
  <nav class="pagination" role="pagination">
    <a class="newer-posts" href="/category/代码学习/page/3/">← Newer Posts</a>
    <span class="page-number">Page 4 of 5</span>
    <a class="older-posts" href="/category/代码学习/page/5/">Older Posts →</a>
  </nav>
</main>


      
<footer class="site-footer">
  
  <div class="inner">
     <section class="copyright">All content copyright <a href="/">Blog of Secer</a> &copy; 2014 &bull; All rights reserved.</section>
     <section class="poweredby">Proudly published with <a class="icon-ghost" href="http://zespia.tw/hexo/">Hexo</a></section>
  </div>
</footer>

      <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>

<script type="text/javascript" src="/js/jquery.fitvids.js"></script>
<script type="text/javascript" src="/js/index.js"></script>
<script type="text/javascript" src="/js/menu.js"></script>





  </div>
</div>

<nav  class="outer-nav top horizontal">

          <a class="icon-home"  href="/"><span>Home</span></a>

          <a class="icon-news"  href="/archives"><span>Archive</span></a>

          <a class="icon-image"  href="/images"><span>Images</span></a>

          <a class="icon-wiki"  href="/wiki/"><span>Wiki</span></a>

          <a class="icon-Favorites"  href="/favorites"><span>Favorites</span></a>

          <a class="icon-mail"  href="/about/"><span>Contact</span></a>

</nav>

</div>
</body>
</html>
