<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" >
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
  <title>Nginx编译选项 | Blog of Secer</title>
  <meta name="description" content="" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="MobileOptimized" content="320" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" type="text/css" href="/css/screen.css" />
  <link rel="stylesheet" type="text/css" href="/css/style.css" />
  <meta name="generator" content="Blog of Secer">

  
  
  

  
</head>

<!--
<body class="post-template">
-->
<body class="home-template">
<div id="perspective" class="perspective effect-movedown">
  <div class="container">
    <!-- wrapper -->
    <div class="wrapper">

      <header class="site-head"  style="background: #24282b url(/img/img-bg.jpg) 0 -20%" >
    <div class="vertical">
        <div class="site-head-content inner">
             <a class="blog-logo" href="/"><img src="/img/logo.svg" alt="Blog Logo"/></a> 
            <h1 class="blog-title">Blog of Secer</h1>
            <h2 class="blog-description"><button id="showMenu">Show Menu</button></h2>
        </div>
    </div>
</header>

      

<main class="content" role="main">
  <article class="post">
    <span class="post-meta">
      <time datetime="2012-07-15T21:34:35.000Z" itemprop="datePublished">
          2012-07-16
      </time>
    
    
    | 
    <a href='/tag/Nginx/'>Nginx</a>
    
    
</span>
    <h1 class="post-title">Nginx编译选项</h1>
    <section class="post-content">
      <p></p><h3>编译选项</h3>  <p>configure 脚本确定系统所具有一些特性，特别是 nginx 用来处理连接的方法。然后，它创建 Makefile 文件。</p>  <p>configure 支持下面的选项：</p>  <p><b>–prefix=</b>&lt;path&gt; - Nginx安装路径。如果没有指定，默认为 /usr/local/nginx。</p>  <p><b>–sbin-path=</b>&lt;path&gt; - Nginx可执行文件安装路径。只能安装时指定，如果没有指定，默认为&lt;prefix&gt;/sbin/nginx。</p>  <p><b>–conf-path=</b>&lt;path&gt; - 在没有给定-c选项下默认的nginx.conf的路径。如果没有指定，默认为&lt;prefix&gt;/conf/nginx.conf。</p>  <p><b>–pid-path=</b>&lt;path&gt; - 在nginx.conf中没有指定pid指令的情况下，默认的nginx.pid的路径。如果没有指定，默认为 &lt;prefix&gt;/logs/nginx.pid。</p>  <p><b>–lock-path=</b>&lt;path&gt; - nginx.lock文件的路径。</p>  <p><b>–error-log-path=</b>&lt;path&gt; - 在nginx.conf中没有指定error_log指令的情况下，默认的错误日志的路径。如果没有指定，默认为 &lt;prefix&gt;/logs/error.log。</p>  <p><b>–http-log-path=</b>&lt;path&gt; - 在nginx.conf中没有指定access_log指令的情况下，默认的访问日志的路径。如果没有指定，默认为 &lt;prefix&gt;/logs/access.log。</p>  <p><b>–user=</b>&lt;user&gt; - 在nginx.conf中没有指定user指令的情况下，默认的nginx使用的用户。如果没有指定，默认为 nobody。</p>  <p><b>–group=</b>&lt;group&gt; - 在nginx.conf中没有指定user指令的情况下，默认的nginx使用的组。如果没有指定，默认为 nobody。</p>  <p><b>–builddir=DIR</b> - 指定编译的目录</p>  <p><b>–with-rtsig_module</b> - 启用 rtsig 模块</p>  <p><b>–with-select_module</b> <b>–without-select_module</b> - Whether or not to enable the select module. This module is enabled by default if a more suitable method such as kqueue, epoll, rtsig or /dev/poll is not discovered by configure.</p>  <p>//允许或不允许开启SELECT模式，如果 configure 没有找到更合适的模式，比如：kqueue(sun os),epoll (linux kenel 2.6+), rtsig(实时信号)或者/dev/poll(一种类似select的模式，底层实现与SELECT基本相 同，都是采用轮训方法) SELECT模式将是默认安装模式</p>  <p><b>–with-poll_module</b> <b>–without-poll_module</b> - Whether or not to enable the poll module. This module is enabled by default if a more suitable method such as kqueue, epoll, rtsig or /dev/poll is not discovered by configure.</p>  <p><b>–with-http_ssl_module</b> - Enable ngx_http_ssl_module. Enables SSL support and the ability to handle HTTPS requests. Requires OpenSSL. On Debian, this is libssl-dev.</p>  <p>//开启HTTP SSL模块，使NGINX可以支持HTTPS请求。这个模块需要已经安装了OPENSSL，在DEBIAN上是libssl-dev</p><a id="more"></a><p></p>  <p><b>–with-http_realip_module</b> - 启用 ngx_http_realip_module</p>  <p><b>–with-http_addition_module</b> - 启用 ngx_http_addition_module</p>  <p><b>–with-http_sub_module</b> - 启用 ngx_http_sub_module</p>  <p><b>–with-http_dav_module</b> - 启用 ngx_http_dav_module</p>  <p><b>–with-http_flv_module</b> - 启用 ngx_http_flv_module</p>  <p><b>–with-http_stub_status_module</b> - 启用 &quot;server status&quot; 页</p>  <p><b>–without-http_charset_module</b> - 禁用 ngx_http_charset_module</p>  <p><b>–without-http_gzip_module</b> - 禁用 ngx_http_gzip_module. 如果启用，需要 zlib 。</p>  <p><b>–without-http_ssi_module</b> - 禁用 ngx_http_ssi_module</p>  <p><b>–without-http_userid_module</b> - 禁用 ngx_http_userid_module</p>  <p><b>–without-http_access_module</b> - 禁用 ngx_http_access_module</p>  <p><b>–without-http_auth_basic_module</b> - 禁用 ngx_http_auth_basic_module</p>  <p><b>–without-http_autoindex_module</b> - 禁用 ngx_http_autoindex_module</p>  <p><b>–without-http_geo_module</b> - 禁用 ngx_http_geo_module</p>  <p><b>–without-http_map_module</b> - 禁用 ngx_http_map_module</p>  <p><b>–without-http_referer_module</b> - 禁用 ngx_http_referer_module</p>  <p><b>–without-http_rewrite_module</b> - 禁用 ngx_http_rewrite_module. 如果启用需要 PCRE 。</p>  <p><b>–without-http_proxy_module</b> - 禁用 ngx_http_proxy_module</p>  <p><b>–without-http_fastcgi_module</b> - 禁用 ngx_http_fastcgi_module</p>  <p><b>–without-http_memcached_module</b> - 禁用 ngx_http_memcached_module</p>  <p><b>–without-http_limit_zone_module</b> - 禁用 ngx_http_limit_zone_module</p>  <p><b>–without-http_empty_gif_module</b> - 禁用 ngx_http_empty_gif_module</p>  <p><b>–without-http_browser_module</b> - 禁用 ngx_http_browser_module</p>  <p><b>–without-http_upstream_ip_hash_module</b> - 禁用 ngx_http_upstream_ip_hash_module</p>  <p><b>–with-http_perl_module</b> - 启用 ngx_http_perl_module</p>  <p><b>–with-perl_modules_path=PATH</b> - 指定 perl 模块的路径</p>  <p><b>–with-perl=PATH</b> - 指定 perl 执行文件的路径</p>  <p><b>–http-log-path=PATH</b> - Set path to the http access log</p>  <p><b>–http-client-body-temp-path=PATH</b> - Set path to the http client request body temporary files</p>  <p><b>–http-proxy-temp-path=PATH</b> - Set path to the http proxy temporary files</p>  <p><b>–http-fastcgi-temp-path=PATH</b> - Set path to the http fastcgi temporary files</p>  <p><b>–without-http</b> - 禁用 HTTP server</p>  <p><b>–with-mail</b> - 启用 IMAP4/POP3/SMTP 代理模块</p>  <p><b>–with-mail_ssl_module</b> - 启用 ngx_mail_ssl_module</p>  <p><b>–with-cc=PATH</b> - 指定 C 编译器的路径</p>  <p><b>–with-cpp=PATH</b> - 指定 C 预处理器的路径</p>  <p><b>–with-cc-opt=OPTIONS</b> - Additional parameters which will be added to the variable CFLAGS. With the use of the system library PCRE in FreeBSD, it is necessary to indicate –with-cc-opt=&quot;-I /usr/local/include&quot;. If we are using select() and it is necessary to increase the number of file descriptors, then this also can be assigned here: –with-cc-opt=&quot;-D FD_SETSIZE=2048&quot;.</p>  <p><b>–with-ld-opt=OPTIONS</b> - Additional parameters passed to the linker. With the use of the system library PCRE in FreeBSD, it is necessary to indicate –with-ld-opt=&quot;-L /usr/local/lib&quot;.</p>  <p><b>–with-cpu-opt=CPU</b> - 为特定的 CPU 编译，有效的值包括：pentium, pentiumpro, pentium3, pentium4, athlon, opteron, amd64, sparc32, sparc64, ppc64</p>  <p><b>–without-pcre</b> - 禁止 PCRE 库的使用。同时也会禁止 HTTP rewrite 模块。在 &quot;location&quot; 配置指令中的正则表达式也需要 PCRE 。</p>  <p><b>–with-pcre=DIR</b> - 指定 PCRE 库的源代码的路径。</p>  <p><b>–with-pcre-opt=OPTIONS</b> - Set additional options for PCRE building.</p>  <p><b>–with-md5=DIR</b> - Set path to md5 library sources.</p>  <p><b>–with-md5-opt=OPTIONS</b> - Set additional options for md5 building.</p>  <p><b>–with-md5-asm</b> - Use md5 assembler sources.</p>  <p><b>–with-sha1=DIR</b> - Set path to sha1 library sources.</p>  <p><b>–with-sha1-opt=OPTIONS</b> - Set additional options for sha1 building.</p>  <p><b>–with-sha1-asm</b> - Use sha1 assembler sources.</p>  <p><b>–with-zlib=DIR</b> - Set path to zlib library sources.</p>  <p><b>–with-zlib-opt=OPTIONS</b> - Set additional options for zlib building.</p>  <p><b>–with-zlib-asm=CPU</b> - Use zlib assembler sources optimized for specified CPU, valid values are: pentium, pentiumpro</p>  <p><b>–with-openssl=DIR</b> - Set path to OpenSSL library sources</p>  <p><b>–with-openssl-opt=OPTIONS</b> - Set additional options for OpenSSL building</p>  <p><b>–with-debug</b> - 启用调试日志</p>  <p><b>–add-module=PATH</b> - Add in a third-party module found in directory PATH</p>  <p>在不同版本间，选项可能会有些许变化，请总是使用 <i>./configure –help</i> 命令来检查一下当前的选项列表。</p>  <h3>示例</h3>  <h4>示例 1</h4>  <p>这只是一行！</p>  <pre>./configure \<br>  –sbin-path=/usr/local/nginx/nginx \<br>  –conf-path=/usr/local/nginx/nginx.conf \<br>  –pid-path=/usr/local/nginx/nginx.pid \<br>  –with-http_ssl_module \<br>  –with-pcre=../pcre-4.4 \<br>  –with-zlib=../zlib-1.1.3</pre><p></p>
<h4>示例 2</h4>

<p>Debian Lenny 默认设置</p>

<pre>./configure \
  --conf-path=/etc/nginx/nginx.conf \
  --error-log-path=/var/log/nginx/error.log \
  --pid-path=/var/run/nginx.pid \
  --lock-path=/var/lock/nginx.lock \
  --http-log-path=/var/log/nginx/access.log \
  --with-http_dav_module \
  --http-client-body-temp-path=/var/lib/nginx/body \
  --with-http_ssl_module \
  --http-proxy-temp-path=/var/lib/nginx/proxy \
  --with-http_stub_status_module \
  --http-fastcgi-temp-path=/var/lib/nginx/fastcgi \
  --with-debug \
  --with-http_flv_module </pre>

<h4>示例 3</h4>

<pre>./configure \
  --prefix=/usr \
  --conf-path=/etc/nginx/nginx.conf \
  --http-log-path=/var/log/nginx/access_log \
  --error-log-path=/var/log/nginx/error_log \
  --pid-path=/var/run/nginx.pid \
  --http-client-body-temp-path=/var/tmp/nginx/client \
  --http-proxy-temp-path=/var/tmp/nginx/proxy \
  --http-fastcgi-temp-path=/var/tmp/nginx/fastcgi \
  --with-md5-asm --with-md5=/usr/include \
  --with-sha1-asm \
  --with-sha1=/usr/include \
  --with-http_realip_module \
  --with-http_ssl_module \
  --with-http_perl_module \
  --with-http_stub_status_module</pre>

<h4>示例 4</h4>

<p>在装有 libgcrypt11-dev, libpcre3-dev and libssl-dev 的 Ubuntu/debian 上 (选择 –with-md5 或者 –with-sha1, 不要同时选择两个; 在 debian 和 ubuntu 上, 通常被指定到 /usr/lib)</p>

<pre>  ./configure --with-openssl=/usr/lib/ssl/ --with-md5=/usr/lib</pre>

<h4>示例 5</h4>

<p>用于 RedHat 系发行版 (RHEL, CentOS, Fedora). 本维基站点的服务器就是以此选项编译.</p>

<p>首先安装需求包:</p>

<pre>yum install gcc openssl-devel pcre-devel zlib-devel</pre>

<p>配置:</p>

<pre>./configure 
  --prefix=/usr \
  --sbin-path=/usr/sbin/nginx \
  --conf-path=/etc/nginx/nginx.conf \
  --error-log-path=/var/log/nginx/error.log \
  --pid-path=/var/run/nginx/nginx.pid  \
  --lock-path=/var/lock/nginx.lock \
  --user=nginx \
  --group=nginx \
  --with-http_ssl_module \
  --with-http_flv_module \
  --with-http_gzip_static_module \
  --http-log-path=/var/log/nginx/access.log \
  --http-client-body-temp-path=/var/tmp/nginx/client/ \
  --http-proxy-temp-path=/var/tmp/nginx/proxy/ \
  --http-fastcgi-temp-path=/var/tmp/nginx/fcgi/ </pre>

<p>最后编译并安装</p>

<pre>make &amp;&amp; make install</pre>
    </section>
    <footer class="post-footer">
      <section class="author">
    <h4>Secer</h4>
    <p>记录互联网安全历程与个人成长经历</p>
</section>
      <section class="share">
    <h4>Share this post</h4>
    <a class="icon-sina-weibo" href="http://v.t.sina.com.cn/share/share.php?title=记录互联网安全历程与个人成长经历 ?url=http://id.cker.in/699.seo/" target="_blank">
        <span class="hidden">weibo</span>
    </a>
    <a class="icon-twitter" href="http://twitter.com/share?url=http://id.cker.in/699.seo/"
       onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
        <span class="hidden">Twitter</span>
    </a>
    <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://id.cker.in/699.seo/"
       onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
        <span class="hidden">Facebook</span>
    </a>
    <a class="icon-google-plus" href="https://plus.google.com/share?url=http://id.cker.in/699.seo/"
       onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
        <span class="hidden">Google+</span>
    </a>
</section>

    </footer>
  </article>
  <nav class="pagination" role="pagination">
    
    <a class="newer-posts" href="/702.seo/">
        ← 法客论坛web渗透测试工具包-第二版
    </a>
    
    <span class="icon-logo">•</span>
    
    <a class="older-posts" href="/692.seo/">
        Wordpress博客搬家 （新手教程） →
    </a>
    
</nav>

  <div id="comment" class="comments-area">
    <h4 class="title"><a href="#disqus_comments" name="disqus_comments">Comments</a></h4>
    
</div>

</main>


      
<footer class="site-footer">
  
  <div class="inner">
     <section class="copyright">All content copyright <a href="/">Blog of Secer</a> &copy; 2014 &bull; All rights reserved.</section>
     <section class="poweredby">Proudly published with <a class="icon-ghost" href="http://zespia.tw/hexo/">Hexo</a></section>
  </div>
</footer>

      <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>

<script type="text/javascript" src="/js/jquery.fitvids.js"></script>
<script type="text/javascript" src="/js/index.js"></script>
<script type="text/javascript" src="/js/menu.js"></script>





  </div>
</div>

<nav  class="outer-nav top horizontal">

          <a class="icon-home"  href="/"><span>Home</span></a>

          <a class="icon-news"  href="/archive"><span>Archive</span></a>

          <a class="icon-image"  href="/images"><span>Images</span></a>

          <a class="icon-wiki"  href="/wiki/2014-10-28-wiki/"><span>Wiki</span></a>

          <a class="icon-Favorites"  href="/favorites"><span>Favorites</span></a>

          <a class="icon-mail"  href="/about/2014-09-11-mabao/"><span>Contact</span></a>

</nav>

</div>
</body>
</html>
